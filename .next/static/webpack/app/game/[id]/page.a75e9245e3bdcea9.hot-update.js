"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/game/[id]/page",{

/***/ "(app-pages-browser)/./src/lib/roomService.ts":
/*!********************************!*\
  !*** ./src/lib/roomService.ts ***!
  \********************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   roomService: function() { return /* binding */ roomService; }\n/* harmony export */ });\n/* harmony import */ var _supabase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./supabase */ \"(app-pages-browser)/./src/lib/supabase.ts\");\n/* harmony import */ var _roleManager__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./roleManager */ \"(app-pages-browser)/./src/lib/roleManager.ts\");\n\n\n// List of debate topics for the MVP\nconst DEBATE_TOPICS = [\n    \"Should AI be regulated?\",\n    \"Is social media harmful to democracy?\",\n    \"Should college education be free?\",\n    \"Is remote work better than office work?\",\n    \"Should voting be mandatory?\",\n    \"Is climate change the most urgent global issue?\",\n    \"Should universal basic income be implemented?\",\n    \"Is social media more harmful than helpful?\",\n    \"Should genetic engineering be widely used?\",\n    \"Is online learning better than traditional classroom education?\"\n];\n// Helper function to generate a proper UUID v4\nfunction generateUUID() {\n    // Use crypto.randomUUID if available (modern browsers)\n    if (typeof crypto !== \"undefined\" && crypto.randomUUID) {\n        return crypto.randomUUID();\n    }\n    // Fallback to manual generation\n    return \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, function(c) {\n        const r = Math.random() * 16 | 0;\n        const v = c === \"x\" ? r : r & 0x3 | 0x8;\n        return v.toString(16);\n    });\n}\n// Validate UUID format\nfunction isValidUUID(uuid) {\n    const uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;\n    return uuidRegex.test(uuid);\n}\nconst roomService = {\n    // Helper to get current Supabase user ID\n    async getUserId () {\n        const { data, error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.auth.getUser();\n        if (error || !(data === null || data === void 0 ? void 0 : data.user)) {\n            return null;\n        }\n        return data.user.id;\n    },\n    // Get session ID from role manager (ensures consistency)\n    getSessionId () {\n        return _roleManager__WEBPACK_IMPORTED_MODULE_1__.roleManager.getSessionId();\n    },\n    // Create a new room with player name\n    async createRoom (playerName) {\n        let userId = await this.getUserId();\n        console.log(\"\\uD83C\\uDFD7️ ROOM SERVICE - Creating room with user:\", userId === null || userId === void 0 ? void 0 : userId.slice(-8));\n        // If no authenticated user, use session UUID for guests\n        if (!userId) {\n            userId = this.getSessionId();\n            console.log(\"\\uD83C\\uDFAF ROOM SERVICE - Using session UUID for creator:\", userId.slice(-8));\n        }\n        // CRITICAL: Validate UUID format before database insertion\n        if (!isValidUUID(userId)) {\n            console.error(\"❌ ROOM SERVICE - Invalid UUID format, generating new one:\", userId);\n            userId = generateUUID();\n            console.log(\"✅ ROOM SERVICE - Generated new valid UUID:\", userId.slice(-8));\n        }\n        const randomTopic = DEBATE_TOPICS[Math.floor(Math.random() * DEBATE_TOPICS.length)];\n        const roomData = {\n            topic: randomTopic,\n            status: \"waiting\",\n            player_a_health: 100,\n            player_b_health: 100,\n            player_a_ready: false,\n            player_b_ready: false,\n            player_a_id: userId,\n            player_a_name: playerName || null\n        };\n        console.log(\"\\uD83C\\uDFD7️ ROOM SERVICE - Room data to insert:\", {\n            ...roomData,\n            player_a_id: roomData.player_a_id.slice(-8)\n        });\n        const { data, error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"rooms\").insert([\n            roomData\n        ]).select().single();\n        if (error) {\n            console.error(\"❌ ROOM SERVICE - Error creating room:\", error);\n            throw new Error(\"Failed to create room: \".concat(error.message));\n        }\n        console.log(\"✅ ROOM SERVICE - Room created successfully\");\n        return {\n            room: data,\n            playerRole: \"player_a\"\n        };\n    },\n    // Join an existing room with proper error handling and player name\n    async joinRoom (roomId, playerName, userId) {\n        try {\n            var _currentRoom_player_a_id, _currentRoom_player_b_id;\n            // Use provided userId or get current user ID or use session ID\n            let actualUserId = userId || await this.getUserId();\n            if (!actualUserId) {\n                actualUserId = this.getSessionId();\n                console.log(\"\\uD83C\\uDFAF ROOM SERVICE - Using session UUID for joiner:\", actualUserId.slice(-8));\n            }\n            // CRITICAL: Validate UUID format before proceeding  \n            if (!isValidUUID(actualUserId)) {\n                console.error(\"❌ ROOM SERVICE - Invalid UUID format, generating new one:\", actualUserId);\n                actualUserId = generateUUID();\n                console.log(\"✅ ROOM SERVICE - Generated new valid UUID:\", actualUserId.slice(-8));\n            }\n            console.log(\"\\uD83D\\uDEAA ROOM SERVICE - Join attempt:\", {\n                roomId: roomId.slice(-8),\n                userId: actualUserId.slice(-8),\n                playerName\n            });\n            // First, check if the room exists and get its current state\n            const { data: currentRoom, error: fetchError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"rooms\").select(\"*\").eq(\"id\", roomId).single();\n            if (fetchError) {\n                console.error(\"❌ ROOM SERVICE - Error fetching room:\", fetchError);\n                if (fetchError.code === \"PGRST116\") {\n                    throw new Error(\"Room not found\");\n                }\n                throw new Error(\"Database error: \".concat(fetchError.message));\n            }\n            if (!currentRoom) {\n                throw new Error(\"Room not found\");\n            }\n            console.log(\"\\uD83C\\uDFE0 ROOM SERVICE - Current room state:\", {\n                id: currentRoom.id.slice(-8),\n                player_a_id: (_currentRoom_player_a_id = currentRoom.player_a_id) === null || _currentRoom_player_a_id === void 0 ? void 0 : _currentRoom_player_a_id.slice(-8),\n                player_b_id: (_currentRoom_player_b_id = currentRoom.player_b_id) === null || _currentRoom_player_b_id === void 0 ? void 0 : _currentRoom_player_b_id.slice(-8),\n                status: currentRoom.status\n            });\n            // Check if user is already in the room\n            if (currentRoom.player_a_id === actualUserId) {\n                console.log(\"✅ ROOM SERVICE - User already in room as Player A\");\n                return {\n                    room: currentRoom,\n                    playerRole: \"player_a\"\n                };\n            }\n            if (currentRoom.player_b_id === actualUserId) {\n                console.log(\"✅ ROOM SERVICE - User already in room as Player B\");\n                return {\n                    room: currentRoom,\n                    playerRole: \"player_b\"\n                };\n            }\n            // Check if room is full\n            if (currentRoom.player_a_id && currentRoom.player_b_id) {\n                throw new Error(\"Room is full\");\n            }\n            // Determine which slot to fill\n            let updateData;\n            let playerRole;\n            if (!currentRoom.player_a_id) {\n                updateData = {\n                    player_a_id: actualUserId,\n                    player_a_ready: false,\n                    player_a_name: playerName || null\n                };\n                playerRole = \"player_a\";\n                console.log(\"\\uD83C\\uDFAD ROOM SERVICE - Joining as Player A\");\n            } else {\n                updateData = {\n                    player_b_id: actualUserId,\n                    player_b_ready: false,\n                    player_b_name: playerName || null\n                };\n                playerRole = \"player_b\";\n                console.log(\"\\uD83C\\uDFAD ROOM SERVICE - Joining as Player B\");\n            }\n            // Update the room\n            const { data: updatedRoom, error: updateError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"rooms\").update(updateData).eq(\"id\", roomId).select().single();\n            if (updateError) {\n                console.error(\"❌ ROOM SERVICE - Error updating room:\", updateError);\n                throw new Error(\"Failed to join room: \".concat(updateError.message));\n            }\n            if (!updatedRoom) {\n                throw new Error(\"Failed to update room - no data returned\");\n            }\n            console.log(\"✅ ROOM SERVICE - Successfully joined as:\", playerRole);\n            return {\n                room: updatedRoom,\n                playerRole\n            };\n        } catch (error) {\n            console.error(\"❌ ROOM SERVICE - Join room error:\", error);\n            throw error;\n        }\n    },\n    // Ready up for the game\n    // Update the readyUp function in src/lib/roomService.ts\n    // Replace the existing readyUp function with this version:\n    // Update the readyUp function in src/lib/roomService.ts\n    // Replace the existing readyUp function with this version:\n    async readyUp (roomId) {\n        try {\n            // Get user ID from role manager for consistency\n            let userId = await this.getUserId();\n            if (!userId) {\n                userId = this.getSessionId();\n            }\n            // Validate UUID format\n            if (!isValidUUID(userId)) {\n                console.error(\"❌ ROOM SERVICE - Invalid UUID format in readyUp:\", userId);\n                userId = generateUUID();\n                console.log(\"✅ ROOM SERVICE - Generated new valid UUID for readyUp:\", userId.slice(-8));\n            }\n            console.log(\"\\uD83D\\uDE80 ROOM SERVICE - Ready up with user:\", userId.slice(-8));\n            // Get current room state\n            const { data: room, error: fetchError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"rooms\").select(\"*\").eq(\"id\", roomId).single();\n            if (fetchError || !room) {\n                console.error(\"❌ ROOM SERVICE - Error fetching room for ready up:\", fetchError);\n                throw new Error(\"Room not found\");\n            }\n            // Determine which player is ready-ing up\n            let updateData = {};\n            if (room.player_a_id === userId) {\n                updateData.player_a_ready = true;\n                console.log(\"\\uD83C\\uDD70️ ROOM SERVICE - Player A readying up\");\n            } else if (room.player_b_id === userId) {\n                updateData.player_b_ready = true;\n                console.log(\"\\uD83C\\uDD71️ ROOM SERVICE - Player B readying up\");\n            } else {\n                var _room_player_a_id, _room_player_b_id;\n                console.error(\"❌ ROOM SERVICE - User not found in room:\", {\n                    userId: userId.slice(-8),\n                    roomPlayerA: (_room_player_a_id = room.player_a_id) === null || _room_player_a_id === void 0 ? void 0 : _room_player_a_id.slice(-8),\n                    roomPlayerB: (_room_player_b_id = room.player_b_id) === null || _room_player_b_id === void 0 ? void 0 : _room_player_b_id.slice(-8)\n                });\n                throw new Error(\"You are not in this room\");\n            }\n            // Check if both players will be ready after this update\n            const bothReady = (room.player_a_id === userId ? true : room.player_a_ready) && (room.player_b_id === userId ? true : room.player_b_ready);\n            console.log(\"✅ ROOM SERVICE - Both players ready after update:\", bothReady);\n            // FIXED: Set to 'ready_to_start' when both players are ready\n            // This triggers the 12-second countdown in GameLobby\n            if (bothReady && room.player_a_id && room.player_b_id) {\n                updateData.status = \"ready_to_start\" // This triggers the GameLobby countdown\n                ;\n                console.log(\"\\uD83C\\uDFAF ROOM SERVICE - Setting room to ready_to_start status (triggers 12s countdown)\");\n            }\n            // Update the room\n            const { data, error: updateError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"rooms\").update(updateData).eq(\"id\", roomId).select().single();\n            if (updateError) {\n                console.error(\"❌ ROOM SERVICE - Error readying up:\", updateError);\n                throw new Error(\"Failed to ready up: \".concat(updateError.message));\n            }\n            console.log(\"✅ ROOM SERVICE - Successfully readied up\");\n            return data;\n        } catch (error) {\n            console.error(\"❌ ROOM SERVICE - Ready up error:\", error);\n            throw error;\n        }\n    },\n    // Also update the startGameWithSideSelection function to ensure it only gets called after the full countdown:\n    async startGameWithSideSelection (roomId) {\n        try {\n            console.log(\"\\uD83C\\uDFAE ROOM SERVICE - Starting game with side selection for room:\", roomId.slice(-8));\n            const deadline = new Date(Date.now() + 10000) // 10 seconds from now for side selection\n            ;\n            const { data, error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"rooms\").update({\n                status: \"debating\",\n                current_phase: \"side_selection\",\n                side_selection_deadline: deadline.toISOString(),\n                phase_start_time: new Date().toISOString(),\n                phase_duration: 10 // 10 seconds for side selection\n            }).eq(\"id\", roomId).select().single();\n            if (error) {\n                console.error(\"❌ ROOM SERVICE - Error starting game with side selection:\", error);\n                throw new Error(\"Failed to start game: \".concat(error.message));\n            }\n            console.log(\"✅ ROOM SERVICE - Game started with side selection successfully\");\n            return data;\n        } catch (error) {\n            console.error(\"❌ ROOM SERVICE - Start game with side selection error:\", error);\n            throw error;\n        }\n    },\n    // Submit side vote\n    async submitSideVote (roomId, side) {\n        try {\n            let userId = await this.getUserId();\n            if (!userId) {\n                userId = this.getSessionId();\n            }\n            // Validate UUID format\n            if (!isValidUUID(userId)) {\n                console.error(\"❌ ROOM SERVICE - Invalid UUID format in submitSideVote:\", userId);\n                userId = generateUUID();\n                console.log(\"✅ ROOM SERVICE - Generated new valid UUID for submitSideVote:\", userId.slice(-8));\n            }\n            console.log(\"\\uD83D\\uDDF3️ ROOM SERVICE - Submitting vote:\", {\n                userId: userId.slice(-8),\n                side,\n                roomId: roomId.slice(-8)\n            });\n            // Get current room to determine player role\n            const { data: room, error: fetchError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"rooms\").select(\"*\").eq(\"id\", roomId).single();\n            if (fetchError || !room) {\n                throw new Error(\"Room not found\");\n            }\n            let updateData = {};\n            if (room.player_a_id === userId) {\n                updateData.player_a_side_vote = side;\n                console.log(\"\\uD83C\\uDD70️ ROOM SERVICE - Player A voted for:\", side);\n            } else if (room.player_b_id === userId) {\n                updateData.player_b_side_vote = side;\n                console.log(\"\\uD83C\\uDD71️ ROOM SERVICE - Player B voted for:\", side);\n            } else {\n                var _room_player_a_id, _room_player_b_id;\n                console.error(\"❌ ROOM SERVICE - User not in room for voting:\", {\n                    userId: userId.slice(-8),\n                    roomPlayerA: (_room_player_a_id = room.player_a_id) === null || _room_player_a_id === void 0 ? void 0 : _room_player_a_id.slice(-8),\n                    roomPlayerB: (_room_player_b_id = room.player_b_id) === null || _room_player_b_id === void 0 ? void 0 : _room_player_b_id.slice(-8)\n                });\n                throw new Error(\"You are not in this room\");\n            }\n            // Update the room with the vote\n            const { data, error: updateError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"rooms\").update(updateData).eq(\"id\", roomId).select().single();\n            if (updateError) {\n                console.error(\"❌ ROOM SERVICE - Error submitting vote:\", updateError);\n                throw new Error(\"Failed to submit vote: \".concat(updateError.message));\n            }\n            console.log(\"✅ ROOM SERVICE - Vote submitted successfully\");\n            return data;\n        } catch (error) {\n            console.error(\"❌ ROOM SERVICE - Submit side vote error:\", error);\n            throw error;\n        }\n    },\n    // Calculate final side assignments after voting period\n    async finalizeSideSelection (roomId) {\n        try {\n            const { data: room, error: fetchError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"rooms\").select(\"*\").eq(\"id\", roomId).single();\n            if (fetchError || !room) {\n                throw new Error(\"Room not found\");\n            }\n            let playerASide;\n            let playerBSide;\n            console.log(\"\\uD83C\\uDFAF ROOM SERVICE - Finalizing side selection:\", {\n                playerAVote: room.player_a_side_vote,\n                playerBVote: room.player_b_side_vote\n            });\n            // Apply side assignment logic\n            if (room.player_a_side_vote && room.player_b_side_vote) {\n                if (room.player_a_side_vote === room.player_b_side_vote) {\n                    // Both chose same side - random assignment\n                    if (Math.random() > 0.5) {\n                        playerASide = \"pro\";\n                        playerBSide = \"con\";\n                    } else {\n                        playerASide = \"con\";\n                        playerBSide = \"pro\";\n                    }\n                    console.log(\"\\uD83C\\uDFB2 ROOM SERVICE - Random assignment (both chose same side)\");\n                } else {\n                    // Different sides - honor their choices\n                    playerASide = room.player_a_side_vote;\n                    playerBSide = room.player_b_side_vote;\n                    console.log(\"✅ ROOM SERVICE - Honored different choices\");\n                }\n            } else if (room.player_a_side_vote && !room.player_b_side_vote) {\n                // Only A voted - A gets choice, B gets opposite\n                playerASide = room.player_a_side_vote;\n                playerBSide = room.player_a_side_vote === \"pro\" ? \"con\" : \"pro\";\n                console.log(\"\\uD83C\\uDD70️ ROOM SERVICE - Only Player A voted\");\n            } else if (!room.player_a_side_vote && room.player_b_side_vote) {\n                // Only B voted - B gets choice, A gets opposite\n                playerBSide = room.player_b_side_vote;\n                playerASide = room.player_b_side_vote === \"pro\" ? \"con\" : \"pro\";\n                console.log(\"\\uD83C\\uDD71️ ROOM SERVICE - Only Player B voted\");\n            } else {\n                // Nobody voted - random assignment\n                if (Math.random() > 0.5) {\n                    playerASide = \"pro\";\n                    playerBSide = \"con\";\n                } else {\n                    playerASide = \"con\";\n                    playerBSide = \"pro\";\n                }\n                console.log(\"\\uD83C\\uDFB2 ROOM SERVICE - Random assignment (no votes)\");\n            }\n            console.log(\"\\uD83C\\uDFAF ROOM SERVICE - Final side assignments:\", {\n                playerASide,\n                playerBSide\n            });\n            // Update room with final assignments and move to opening prep phase\n            const { data, error: updateError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"rooms\").update({\n                player_a_side: playerASide,\n                player_b_side: playerBSide,\n                current_phase: \"opening_prep\",\n                phase_start_time: new Date().toISOString(),\n                phase_duration: 30 // 30 seconds for opening prep\n            }).eq(\"id\", roomId).select().single();\n            if (updateError) {\n                console.error(\"❌ ROOM SERVICE - Error finalizing side selection:\", updateError);\n                throw new Error(\"Failed to finalize sides: \".concat(updateError.message));\n            }\n            console.log(\"✅ ROOM SERVICE - Side selection finalized\");\n            return data;\n        } catch (error) {\n            console.error(\"❌ ROOM SERVICE - Finalize side selection error:\", error);\n            throw error;\n        }\n    },\n    // Send a chat message during debate\n    async sendMessage (roomId, content, phase, playerSide, playerRole) {\n        try {\n            let userId = await this.getUserId();\n            if (!userId) {\n                userId = this.getSessionId();\n            }\n            // Validate UUID format\n            if (!isValidUUID(userId)) {\n                console.error(\"❌ ROOM SERVICE - Invalid UUID format in sendMessage:\", userId);\n                userId = generateUUID();\n                console.log(\"✅ ROOM SERVICE - Generated new valid UUID for sendMessage:\", userId.slice(-8));\n            }\n            console.log(\"\\uD83D\\uDCAC ROOM SERVICE - Sending message:\", {\n                roomId: roomId.slice(-8),\n                userId: userId.slice(-8),\n                phase,\n                playerSide,\n                contentLength: content.length\n            });\n            // Get the room to find the player's name\n            const { data: room } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"rooms\").select(\"player_a_name, player_b_name, player_a_id, player_b_id\").eq(\"id\", roomId).single();\n            // Determine sender name - use stored name or fallback\n            let senderName = \"\".concat(playerRole === \"player_a\" ? \"Player A\" : \"Player B\", \" (\").concat(playerSide.toUpperCase(), \")\");\n            if (room) {\n                const storedName = playerRole === \"player_a\" ? room.player_a_name : room.player_b_name;\n                if (storedName) {\n                    senderName = \"\".concat(storedName, \" (\").concat(playerSide.toUpperCase(), \")\");\n                }\n            }\n            const messageData = {\n                room_id: roomId,\n                user_id: userId,\n                sender_name: senderName,\n                content: content,\n                phase: phase,\n                player_side: playerSide\n            };\n            const { data, error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"messages\").insert([\n                messageData\n            ]).select().single();\n            if (error) {\n                console.error(\"❌ ROOM SERVICE - Error sending message:\", error);\n                throw new Error(\"Failed to send message: \".concat(error.message));\n            }\n            console.log(\"✅ ROOM SERVICE - Message sent successfully\");\n            return data;\n        } catch (error) {\n            console.error(\"❌ ROOM SERVICE - Send message error:\", error);\n            throw error;\n        }\n    },\n    // Get all messages for a room\n    async getMessages (roomId) {\n        try {\n            console.log(\"\\uD83D\\uDCDC ROOM SERVICE - Loading messages for room:\", roomId.slice(-8));\n            const { data, error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"messages\").select(\"*\").eq(\"room_id\", roomId).order(\"created_at\", {\n                ascending: true\n            });\n            if (error) {\n                console.error(\"❌ ROOM SERVICE - Error loading messages:\", error);\n                throw new Error(\"Failed to load messages: \".concat(error.message));\n            }\n            console.log(\"✅ ROOM SERVICE - Loaded messages:\", (data === null || data === void 0 ? void 0 : data.length) || 0);\n            return data || [];\n        } catch (error) {\n            console.error(\"❌ ROOM SERVICE - Get messages error:\", error);\n            return [];\n        }\n    },\n    // Subscribe to new messages in real-time\n    subscribeToMessages (roomId, callback) {\n        console.log(\"\\uD83D\\uDCE1 ROOM SERVICE - Setting up message subscription for room:\", roomId.slice(-8));\n        const channel = _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.channel(\"messages:\".concat(roomId, \":\").concat(Date.now())).on(\"postgres_changes\", {\n            event: \"INSERT\",\n            schema: \"public\",\n            table: \"messages\",\n            filter: \"room_id=eq.\".concat(roomId)\n        }, (payload)=>{\n            var _payload_new, _payload_new1, _payload_new2, _payload_new_content, _payload_new3;\n            console.log(\"\\uD83D\\uDCAC ROOM SERVICE - New message received:\", {\n                sender: (_payload_new = payload.new) === null || _payload_new === void 0 ? void 0 : _payload_new.sender_name,\n                phase: (_payload_new1 = payload.new) === null || _payload_new1 === void 0 ? void 0 : _payload_new1.phase,\n                side: (_payload_new2 = payload.new) === null || _payload_new2 === void 0 ? void 0 : _payload_new2.player_side,\n                contentLength: (_payload_new3 = payload.new) === null || _payload_new3 === void 0 ? void 0 : (_payload_new_content = _payload_new3.content) === null || _payload_new_content === void 0 ? void 0 : _payload_new_content.length\n            });\n            if (payload.new) {\n                callback(payload.new);\n            }\n        }).subscribe((status, error)=>{\n            console.log(\"\\uD83D\\uDCE1 ROOM SERVICE - Message subscription status:\", status);\n            if (error) {\n                console.error(\"❌ ROOM SERVICE - Message subscription error:\", error);\n            }\n            if (status === \"SUBSCRIBED\") {\n                console.log(\"✅ ROOM SERVICE - Successfully subscribed to message updates\");\n            }\n        });\n        return channel;\n    },\n    // Unready\n    async unready (roomId) {\n        try {\n            let userId = await this.getUserId();\n            if (!userId) {\n                userId = this.getSessionId();\n            }\n            // Validate UUID format\n            if (!isValidUUID(userId)) {\n                console.error(\"❌ ROOM SERVICE - Invalid UUID format in unready:\", userId);\n                userId = generateUUID();\n                console.log(\"✅ ROOM SERVICE - Generated new valid UUID for unready:\", userId.slice(-8));\n            }\n            const { data: room, error: fetchError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"rooms\").select(\"*\").eq(\"id\", roomId).single();\n            if (fetchError || !room) {\n                throw new Error(\"Room not found\");\n            }\n            let updateData = {};\n            if (room.player_a_id === userId) {\n                updateData.player_a_ready = false;\n                console.log(\"\\uD83C\\uDD70️ ROOM SERVICE - Player A unreadying\");\n            } else if (room.player_b_id === userId) {\n                updateData.player_b_ready = false;\n                console.log(\"\\uD83C\\uDD71️ ROOM SERVICE - Player B unreadying\");\n            } else {\n                throw new Error(\"You are not in this room\");\n            }\n            // Reset to waiting status\n            updateData.status = \"waiting\";\n            updateData.current_phase = null;\n            const { data, error: updateError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"rooms\").update(updateData).eq(\"id\", roomId).select().single();\n            if (updateError) {\n                console.error(\"❌ ROOM SERVICE - Error unreadying:\", updateError);\n                throw new Error(\"Failed to unready: \".concat(updateError.message));\n            }\n            console.log(\"✅ ROOM SERVICE - Successfully unreadied\");\n            return data;\n        } catch (error) {\n            console.error(\"❌ ROOM SERVICE - Unready error:\", error);\n            throw error;\n        }\n    },\n    // Leave room\n    async leaveRoom (roomId) {\n        try {\n            let userId = await this.getUserId();\n            if (!userId) {\n                userId = this.getSessionId();\n            }\n            // Validate UUID format\n            if (!isValidUUID(userId)) {\n                console.error(\"❌ ROOM SERVICE - Invalid UUID format in leaveRoom:\", userId);\n                userId = generateUUID();\n                console.log(\"✅ ROOM SERVICE - Generated new valid UUID for leaveRoom:\", userId.slice(-8));\n            }\n            console.log(\"\\uD83D\\uDEAA ROOM SERVICE - Leaving room:\", {\n                roomId: roomId.slice(-8),\n                userId: userId.slice(-8)\n            });\n            const { data: room, error: fetchError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"rooms\").select(\"*\").eq(\"id\", roomId).single();\n            if (fetchError || !room) {\n                throw new Error(\"Room not found\");\n            }\n            let updateData = {};\n            if (room.player_a_id === userId) {\n                updateData.player_a_id = null;\n                updateData.player_a_ready = false;\n                updateData.player_a_side_vote = null;\n                updateData.player_a_side = null;\n                updateData.player_a_name = null;\n                console.log(\"\\uD83C\\uDD70️ ROOM SERVICE - Player A leaving\");\n            } else if (room.player_b_id === userId) {\n                updateData.player_b_id = null;\n                updateData.player_b_ready = false;\n                updateData.player_b_side_vote = null;\n                updateData.player_b_side = null;\n                updateData.player_b_name = null;\n                console.log(\"\\uD83C\\uDD71️ ROOM SERVICE - Player B leaving\");\n            } else {\n                throw new Error(\"You are not in this room\");\n            }\n            // Reset room status to waiting\n            updateData.status = \"waiting\";\n            updateData.current_phase = null;\n            const { error: updateError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"rooms\").update(updateData).eq(\"id\", roomId);\n            if (updateError) {\n                console.error(\"❌ ROOM SERVICE - Error leaving room:\", updateError);\n                throw new Error(\"Failed to leave room: \".concat(updateError.message));\n            }\n            console.log(\"✅ ROOM SERVICE - Successfully left room\");\n            return true;\n        } catch (error) {\n            console.error(\"❌ ROOM SERVICE - Leave room error:\", error);\n            throw error;\n        }\n    },\n    // Get room details\n    async getRoom (roomId) {\n        try {\n            const { data, error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"rooms\").select(\"*\").eq(\"id\", roomId).single();\n            if (error) {\n                if (error.code === \"PGRST116\") {\n                    return null // Room not found\n                    ;\n                }\n                console.error(\"❌ ROOM SERVICE - Error fetching room:\", error);\n                throw error;\n            }\n            return data;\n        } catch (error) {\n            console.error(\"❌ ROOM SERVICE - Get room error:\", error);\n            return null;\n        }\n    },\n    // Start opening prep phase\n    async startOpeningPrep (roomId) {\n        try {\n            console.log(\"\\uD83D\\uDCDD ROOM SERVICE - Starting opening prep phase for room:\", roomId.slice(-8));\n            const { data, error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"rooms\").update({\n                current_phase: \"opening_prep\",\n                phase_start_time: new Date().toISOString(),\n                phase_duration: 30 // 30 seconds for prep\n            }).eq(\"id\", roomId).select().single();\n            if (error) {\n                console.error(\"❌ ROOM SERVICE - Error starting opening prep:\", error);\n                throw new Error(\"Failed to start opening prep: \".concat(error.message));\n            }\n            console.log(\"✅ ROOM SERVICE - Opening prep started successfully\");\n            return data;\n        } catch (error) {\n            console.error(\"❌ ROOM SERVICE - Start opening prep error:\", error);\n            throw error;\n        }\n    },\n    // Start opening statements phase\n    async startOpeningStatements (roomId) {\n        try {\n            console.log(\"\\uD83C\\uDFA4 ROOM SERVICE - Starting opening statements for room:\", roomId.slice(-8));\n            const { data, error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"rooms\").update({\n                current_phase: \"opening\",\n                phase_start_time: new Date().toISOString(),\n                phase_duration: 70 // 30s + 10s transition + 30s\n            }).eq(\"id\", roomId).select().single();\n            if (error) {\n                console.error(\"❌ ROOM SERVICE - Error starting opening statements:\", error);\n                throw new Error(\"Failed to start opening statements: \".concat(error.message));\n            }\n            console.log(\"✅ ROOM SERVICE - Opening statements started successfully\");\n            return data;\n        } catch (error) {\n            console.error(\"❌ ROOM SERVICE - Start opening statements error:\", error);\n            throw error;\n        }\n    },\n    // Start rebuttal phase\n    async startRebuttalPhase (roomId) {\n        try {\n            console.log(\"\\uD83D\\uDD04 ROOM SERVICE - Starting rebuttal phase for room:\", roomId.slice(-8));\n            const { data, error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"rooms\").update({\n                current_phase: \"rebuttal\",\n                phase_start_time: new Date().toISOString(),\n                phase_duration: 70 // 30s + 10s transition + 30s (same as opening)\n            }).eq(\"id\", roomId).select().single();\n            if (error) {\n                console.error(\"❌ ROOM SERVICE - Error starting rebuttal phase:\", error);\n                throw new Error(\"Failed to start rebuttal phase: \".concat(error.message));\n            }\n            console.log(\"✅ ROOM SERVICE - Rebuttal phase started successfully\");\n            return data;\n        } catch (error) {\n            console.error(\"❌ ROOM SERVICE - Start rebuttal phase error:\", error);\n            throw error;\n        }\n    },\n    // Enhanced subscription with better error handling\n    subscribeToRoom (roomId, callback) {\n        console.log(\"\\uD83D\\uDCE1 ROOM SERVICE - Setting up subscription for room:\", roomId.slice(-8));\n        const channel = _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.channel(\"room:\".concat(roomId, \":\").concat(Date.now())).on(\"postgres_changes\", {\n            event: \"*\",\n            schema: \"public\",\n            table: \"rooms\",\n            filter: \"id=eq.\".concat(roomId)\n        }, (payload)=>{\n            console.log(\"\\uD83D\\uDD04 ROOM SERVICE - Real-time update received:\", {\n                event: payload.eventType,\n                new: payload.new ? {\n                    id: payload.new.id.slice(-8),\n                    player_a_id: payload.new.player_a_id ? payload.new.player_a_id.slice(-8) : null,\n                    player_b_id: payload.new.player_b_id ? payload.new.player_b_id.slice(-8) : null,\n                    status: payload.new.status,\n                    current_phase: payload.new.current_phase\n                } : null\n            });\n            if (payload.new) {\n                callback(payload.new);\n            }\n        }).subscribe((status, error)=>{\n            console.log(\"\\uD83D\\uDCE1 ROOM SERVICE - Subscription status:\", status);\n            if (error) {\n                console.error(\"❌ ROOM SERVICE - Subscription error:\", error);\n            }\n            if (status === \"SUBSCRIBED\") {\n                console.log(\"✅ ROOM SERVICE - Successfully subscribed to room updates\");\n            }\n        });\n        return channel;\n    }\n};\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3NyYy9saWIvcm9vbVNlcnZpY2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQXFDO0FBRU07QUFFM0Msb0NBQW9DO0FBQ3BDLE1BQU1FLGdCQUFnQjtJQUNwQjtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtDQUNEO0FBRUQsK0NBQStDO0FBQy9DLFNBQVNDO0lBQ1AsdURBQXVEO0lBQ3ZELElBQUksT0FBT0MsV0FBVyxlQUFlQSxPQUFPQyxVQUFVLEVBQUU7UUFDdEQsT0FBT0QsT0FBT0MsVUFBVTtJQUMxQjtJQUVBLGdDQUFnQztJQUNoQyxPQUFPLHVDQUF1Q0MsT0FBTyxDQUFDLFNBQVMsU0FBU0MsQ0FBQztRQUN2RSxNQUFNQyxJQUFJLEtBQU1FLE1BQU0sS0FBSyxLQUFNO1FBQ2pDLE1BQU1DLElBQUlKLE1BQU0sTUFBTUMsSUFBSSxJQUFLLE1BQU87UUFDdEMsT0FBT0csRUFBRUMsUUFBUSxDQUFDO0lBQ3BCO0FBQ0Y7QUFFQSx1QkFBdUI7QUFDdkIsU0FBU0MsWUFBWUMsSUFBWTtJQUMvQixNQUFNQyxZQUFZO0lBQ2xCLE9BQU9BLFVBQVVDLElBQUksQ0FBQ0Y7QUFDeEI7QUFFTyxNQUFNRyxjQUFjO0lBQ3pCLHlDQUF5QztJQUN6QyxNQUFNQztRQUNKLE1BQU0sRUFBRUMsSUFBSSxFQUFFQyxLQUFLLEVBQUUsR0FBRyxNQUFNcEIsK0NBQVFBLENBQUNxQixJQUFJLENBQUNDLE9BQU87UUFDbkQsSUFBSUYsU0FBUyxFQUFDRCxpQkFBQUEsMkJBQUFBLEtBQU1JLElBQUksR0FBRTtZQUN4QixPQUFPO1FBQ1Q7UUFDQSxPQUFPSixLQUFLSSxJQUFJLENBQUNDLEVBQUU7SUFDckI7SUFFQSx5REFBeUQ7SUFDekRDO1FBQ0UsT0FBT3hCLHFEQUFXQSxDQUFDd0IsWUFBWTtJQUNqQztJQUVBLHFDQUFxQztJQUNyQyxNQUFNQyxZQUFXQyxVQUFtQjtRQUNsQyxJQUFJQyxTQUFTLE1BQU0s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O0lBQ1Q7QUFDRixFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL3NyYy9saWIvcm9vbVNlcnZpY2UudHM/YmUxMiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBzdXBhYmFzZSB9IGZyb20gJy4vc3VwYWJhc2UnXG5pbXBvcnQgeyBSb29tLCBNZXNzYWdlIH0gZnJvbSAnLi9zdXBhYmFzZSdcbmltcG9ydCB7IHJvbGVNYW5hZ2VyIH0gZnJvbSAnLi9yb2xlTWFuYWdlcidcblxuLy8gTGlzdCBvZiBkZWJhdGUgdG9waWNzIGZvciB0aGUgTVZQXG5jb25zdCBERUJBVEVfVE9QSUNTID0gW1xuICBcIlNob3VsZCBBSSBiZSByZWd1bGF0ZWQ/XCIsXG4gIFwiSXMgc29jaWFsIG1lZGlhIGhhcm1mdWwgdG8gZGVtb2NyYWN5P1wiLFxuICBcIlNob3VsZCBjb2xsZWdlIGVkdWNhdGlvbiBiZSBmcmVlP1wiLFxuICBcIklzIHJlbW90ZSB3b3JrIGJldHRlciB0aGFuIG9mZmljZSB3b3JrP1wiLFxuICBcIlNob3VsZCB2b3RpbmcgYmUgbWFuZGF0b3J5P1wiLFxuICBcIklzIGNsaW1hdGUgY2hhbmdlIHRoZSBtb3N0IHVyZ2VudCBnbG9iYWwgaXNzdWU/XCIsXG4gIFwiU2hvdWxkIHVuaXZlcnNhbCBiYXNpYyBpbmNvbWUgYmUgaW1wbGVtZW50ZWQ/XCIsXG4gIFwiSXMgc29jaWFsIG1lZGlhIG1vcmUgaGFybWZ1bCB0aGFuIGhlbHBmdWw/XCIsXG4gIFwiU2hvdWxkIGdlbmV0aWMgZW5naW5lZXJpbmcgYmUgd2lkZWx5IHVzZWQ/XCIsXG4gIFwiSXMgb25saW5lIGxlYXJuaW5nIGJldHRlciB0aGFuIHRyYWRpdGlvbmFsIGNsYXNzcm9vbSBlZHVjYXRpb24/XCJcbl1cblxuLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGdlbmVyYXRlIGEgcHJvcGVyIFVVSUQgdjRcbmZ1bmN0aW9uIGdlbmVyYXRlVVVJRCgpOiBzdHJpbmcge1xuICAvLyBVc2UgY3J5cHRvLnJhbmRvbVVVSUQgaWYgYXZhaWxhYmxlIChtb2Rlcm4gYnJvd3NlcnMpXG4gIGlmICh0eXBlb2YgY3J5cHRvICE9PSAndW5kZWZpbmVkJyAmJiBjcnlwdG8ucmFuZG9tVVVJRCkge1xuICAgIHJldHVybiBjcnlwdG8ucmFuZG9tVVVJRCgpXG4gIH1cbiAgXG4gIC8vIEZhbGxiYWNrIHRvIG1hbnVhbCBnZW5lcmF0aW9uXG4gIHJldHVybiAneHh4eHh4eHgteHh4eC00eHh4LXl4eHgteHh4eHh4eHh4eHh4Jy5yZXBsYWNlKC9beHldL2csIGZ1bmN0aW9uKGMpIHtcbiAgICBjb25zdCByID0gKE1hdGgucmFuZG9tKCkgKiAxNikgfCAwXG4gICAgY29uc3QgdiA9IGMgPT09ICd4JyA/IHIgOiAociAmIDB4MykgfCAweDhcbiAgICByZXR1cm4gdi50b1N0cmluZygxNilcbiAgfSlcbn1cblxuLy8gVmFsaWRhdGUgVVVJRCBmb3JtYXRcbmZ1bmN0aW9uIGlzVmFsaWRVVUlEKHV1aWQ6IHN0cmluZyk6IGJvb2xlYW4ge1xuICBjb25zdCB1dWlkUmVnZXggPSAvXlswLTlhLWZdezh9LVswLTlhLWZdezR9LTRbMC05YS1mXXszfS1bODlhYl1bMC05YS1mXXszfS1bMC05YS1mXXsxMn0kL2lcbiAgcmV0dXJuIHV1aWRSZWdleC50ZXN0KHV1aWQpXG59XG5cbmV4cG9ydCBjb25zdCByb29tU2VydmljZSA9IHtcbiAgLy8gSGVscGVyIHRvIGdldCBjdXJyZW50IFN1cGFiYXNlIHVzZXIgSURcbiAgYXN5bmMgZ2V0VXNlcklkKCk6IFByb21pc2U8c3RyaW5nIHwgbnVsbD4ge1xuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguZ2V0VXNlcigpXG4gICAgaWYgKGVycm9yIHx8ICFkYXRhPy51c2VyKSB7XG4gICAgICByZXR1cm4gbnVsbFxuICAgIH1cbiAgICByZXR1cm4gZGF0YS51c2VyLmlkXG4gIH0sXG5cbiAgLy8gR2V0IHNlc3Npb24gSUQgZnJvbSByb2xlIG1hbmFnZXIgKGVuc3VyZXMgY29uc2lzdGVuY3kpXG4gIGdldFNlc3Npb25JZCgpOiBzdHJpbmcge1xuICAgIHJldHVybiByb2xlTWFuYWdlci5nZXRTZXNzaW9uSWQoKVxuICB9LFxuXG4gIC8vIENyZWF0ZSBhIG5ldyByb29tIHdpdGggcGxheWVyIG5hbWVcbiAgYXN5bmMgY3JlYXRlUm9vbShwbGF5ZXJOYW1lPzogc3RyaW5nKTogUHJvbWlzZTx7IHJvb206IFJvb207IHBsYXllclJvbGU6ICdwbGF5ZXJfYScgfCAncGxheWVyX2InIH0+IHtcbiAgICBsZXQgdXNlcklkID0gYXdhaXQgdGhpcy5nZXRVc2VySWQoKVxuICAgIFxuICAgIGNvbnNvbGUubG9nKCfwn4+X77iPIFJPT00gU0VSVklDRSAtIENyZWF0aW5nIHJvb20gd2l0aCB1c2VyOicsIHVzZXJJZD8uc2xpY2UoLTgpKVxuICAgIFxuICAgIC8vIElmIG5vIGF1dGhlbnRpY2F0ZWQgdXNlciwgdXNlIHNlc3Npb24gVVVJRCBmb3IgZ3Vlc3RzXG4gICAgaWYgKCF1c2VySWQpIHtcbiAgICAgIHVzZXJJZCA9IHRoaXMuZ2V0U2Vzc2lvbklkKClcbiAgICAgIGNvbnNvbGUubG9nKCfwn46vIFJPT00gU0VSVklDRSAtIFVzaW5nIHNlc3Npb24gVVVJRCBmb3IgY3JlYXRvcjonLCB1c2VySWQuc2xpY2UoLTgpKVxuICAgIH1cbiAgICBcbiAgICAvLyBDUklUSUNBTDogVmFsaWRhdGUgVVVJRCBmb3JtYXQgYmVmb3JlIGRhdGFiYXNlIGluc2VydGlvblxuICAgIGlmICghaXNWYWxpZFVVSUQodXNlcklkKSkge1xuICAgICAgY29uc29sZS5lcnJvcign4p2MIFJPT00gU0VSVklDRSAtIEludmFsaWQgVVVJRCBmb3JtYXQsIGdlbmVyYXRpbmcgbmV3IG9uZTonLCB1c2VySWQpXG4gICAgICB1c2VySWQgPSBnZW5lcmF0ZVVVSUQoKVxuICAgICAgY29uc29sZS5sb2coJ+KchSBST09NIFNFUlZJQ0UgLSBHZW5lcmF0ZWQgbmV3IHZhbGlkIFVVSUQ6JywgdXNlcklkLnNsaWNlKC04KSlcbiAgICB9XG4gICAgXG4gICAgY29uc3QgcmFuZG9tVG9waWMgPSBERUJBVEVfVE9QSUNTW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIERFQkFURV9UT1BJQ1MubGVuZ3RoKV1cblxuICAgIGNvbnN0IHJvb21EYXRhID0ge1xuICAgICAgdG9waWM6IHJhbmRvbVRvcGljLFxuICAgICAgc3RhdHVzOiAnd2FpdGluZycgYXMgY29uc3QsXG4gICAgICBwbGF5ZXJfYV9oZWFsdGg6IDEwMCxcbiAgICAgIHBsYXllcl9iX2hlYWx0aDogMTAwLFxuICAgICAgcGxheWVyX2FfcmVhZHk6IGZhbHNlLFxuICAgICAgcGxheWVyX2JfcmVhZHk6IGZhbHNlLFxuICAgICAgcGxheWVyX2FfaWQ6IHVzZXJJZCxcbiAgICAgIHBsYXllcl9hX25hbWU6IHBsYXllck5hbWUgfHwgbnVsbCwgLy8gU3RvcmUgdGhlIHBsYXllciBuYW1lXG4gICAgfVxuICAgIFxuICAgIGNvbnNvbGUubG9nKCfwn4+X77iPIFJPT00gU0VSVklDRSAtIFJvb20gZGF0YSB0byBpbnNlcnQ6Jywge1xuICAgICAgLi4ucm9vbURhdGEsXG4gICAgICBwbGF5ZXJfYV9pZDogcm9vbURhdGEucGxheWVyX2FfaWQuc2xpY2UoLTgpXG4gICAgfSlcblxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgncm9vbXMnKVxuICAgICAgLmluc2VydChbcm9vbURhdGFdKVxuICAgICAgLnNlbGVjdCgpXG4gICAgICAuc2luZ2xlKClcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign4p2MIFJPT00gU0VSVklDRSAtIEVycm9yIGNyZWF0aW5nIHJvb206JywgZXJyb3IpXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBjcmVhdGUgcm9vbTogJHtlcnJvci5tZXNzYWdlfWApXG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coJ+KchSBST09NIFNFUlZJQ0UgLSBSb29tIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5JylcbiAgICByZXR1cm4geyByb29tOiBkYXRhLCBwbGF5ZXJSb2xlOiAncGxheWVyX2EnIH1cbiAgfSxcblxuICAvLyBKb2luIGFuIGV4aXN0aW5nIHJvb20gd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcgYW5kIHBsYXllciBuYW1lXG4gIGFzeW5jIGpvaW5Sb29tKHJvb21JZDogc3RyaW5nLCBwbGF5ZXJOYW1lPzogc3RyaW5nLCB1c2VySWQ/OiBzdHJpbmcpOiBQcm9taXNlPHsgcm9vbTogUm9vbTsgcGxheWVyUm9sZTogJ3BsYXllcl9hJyB8ICdwbGF5ZXJfYicgfT4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBVc2UgcHJvdmlkZWQgdXNlcklkIG9yIGdldCBjdXJyZW50IHVzZXIgSUQgb3IgdXNlIHNlc3Npb24gSURcbiAgICAgIGxldCBhY3R1YWxVc2VySWQgPSB1c2VySWQgfHwgYXdhaXQgdGhpcy5nZXRVc2VySWQoKVxuICAgICAgaWYgKCFhY3R1YWxVc2VySWQpIHtcbiAgICAgICAgYWN0dWFsVXNlcklkID0gdGhpcy5nZXRTZXNzaW9uSWQoKVxuICAgICAgICBjb25zb2xlLmxvZygn8J+OryBST09NIFNFUlZJQ0UgLSBVc2luZyBzZXNzaW9uIFVVSUQgZm9yIGpvaW5lcjonLCBhY3R1YWxVc2VySWQuc2xpY2UoLTgpKVxuICAgICAgfVxuXG4gICAgICAvLyBDUklUSUNBTDogVmFsaWRhdGUgVVVJRCBmb3JtYXQgYmVmb3JlIHByb2NlZWRpbmcgIFxuICAgICAgaWYgKCFpc1ZhbGlkVVVJRChhY3R1YWxVc2VySWQpKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBST09NIFNFUlZJQ0UgLSBJbnZhbGlkIFVVSUQgZm9ybWF0LCBnZW5lcmF0aW5nIG5ldyBvbmU6JywgYWN0dWFsVXNlcklkKVxuICAgICAgICBhY3R1YWxVc2VySWQgPSBnZW5lcmF0ZVVVSUQoKVxuICAgICAgICBjb25zb2xlLmxvZygn4pyFIFJPT00gU0VSVklDRSAtIEdlbmVyYXRlZCBuZXcgdmFsaWQgVVVJRDonLCBhY3R1YWxVc2VySWQuc2xpY2UoLTgpKVxuICAgICAgfVxuXG4gICAgICBjb25zb2xlLmxvZygn8J+aqiBST09NIFNFUlZJQ0UgLSBKb2luIGF0dGVtcHQ6Jywge1xuICAgICAgICByb29tSWQ6IHJvb21JZC5zbGljZSgtOCksXG4gICAgICAgIHVzZXJJZDogYWN0dWFsVXNlcklkLnNsaWNlKC04KSxcbiAgICAgICAgcGxheWVyTmFtZVxuICAgICAgfSlcblxuICAgICAgLy8gRmlyc3QsIGNoZWNrIGlmIHRoZSByb29tIGV4aXN0cyBhbmQgZ2V0IGl0cyBjdXJyZW50IHN0YXRlXG4gICAgICBjb25zdCB7IGRhdGE6IGN1cnJlbnRSb29tLCBlcnJvcjogZmV0Y2hFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3Jvb21zJylcbiAgICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAgIC5lcSgnaWQnLCByb29tSWQpXG4gICAgICAgIC5zaW5nbGUoKVxuXG4gICAgICBpZiAoZmV0Y2hFcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgUk9PTSBTRVJWSUNFIC0gRXJyb3IgZmV0Y2hpbmcgcm9vbTonLCBmZXRjaEVycm9yKVxuICAgICAgICBpZiAoZmV0Y2hFcnJvci5jb2RlID09PSAnUEdSU1QxMTYnKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdSb29tIG5vdCBmb3VuZCcpXG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBEYXRhYmFzZSBlcnJvcjogJHtmZXRjaEVycm9yLm1lc3NhZ2V9YClcbiAgICAgIH1cblxuICAgICAgaWYgKCFjdXJyZW50Um9vbSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Jvb20gbm90IGZvdW5kJylcbiAgICAgIH1cblxuICAgICAgY29uc29sZS5sb2coJ/Cfj6AgUk9PTSBTRVJWSUNFIC0gQ3VycmVudCByb29tIHN0YXRlOicsIHtcbiAgICAgICAgaWQ6IGN1cnJlbnRSb29tLmlkLnNsaWNlKC04KSxcbiAgICAgICAgcGxheWVyX2FfaWQ6IGN1cnJlbnRSb29tLnBsYXllcl9hX2lkPy5zbGljZSgtOCksXG4gICAgICAgIHBsYXllcl9iX2lkOiBjdXJyZW50Um9vbS5wbGF5ZXJfYl9pZD8uc2xpY2UoLTgpLFxuICAgICAgICBzdGF0dXM6IGN1cnJlbnRSb29tLnN0YXR1c1xuICAgICAgfSlcblxuICAgICAgLy8gQ2hlY2sgaWYgdXNlciBpcyBhbHJlYWR5IGluIHRoZSByb29tXG4gICAgICBpZiAoY3VycmVudFJvb20ucGxheWVyX2FfaWQgPT09IGFjdHVhbFVzZXJJZCkge1xuICAgICAgICBjb25zb2xlLmxvZygn4pyFIFJPT00gU0VSVklDRSAtIFVzZXIgYWxyZWFkeSBpbiByb29tIGFzIFBsYXllciBBJylcbiAgICAgICAgcmV0dXJuIHsgcm9vbTogY3VycmVudFJvb20sIHBsYXllclJvbGU6ICdwbGF5ZXJfYScgfVxuICAgICAgfVxuICAgICAgXG4gICAgICBpZiAoY3VycmVudFJvb20ucGxheWVyX2JfaWQgPT09IGFjdHVhbFVzZXJJZCkge1xuICAgICAgICBjb25zb2xlLmxvZygn4pyFIFJPT00gU0VSVklDRSAtIFVzZXIgYWxyZWFkeSBpbiByb29tIGFzIFBsYXllciBCJylcbiAgICAgICAgcmV0dXJuIHsgcm9vbTogY3VycmVudFJvb20sIHBsYXllclJvbGU6ICdwbGF5ZXJfYicgfVxuICAgICAgfVxuXG4gICAgICAvLyBDaGVjayBpZiByb29tIGlzIGZ1bGxcbiAgICAgIGlmIChjdXJyZW50Um9vbS5wbGF5ZXJfYV9pZCAmJiBjdXJyZW50Um9vbS5wbGF5ZXJfYl9pZCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Jvb20gaXMgZnVsbCcpXG4gICAgICB9XG5cbiAgICAgIC8vIERldGVybWluZSB3aGljaCBzbG90IHRvIGZpbGxcbiAgICAgIGxldCB1cGRhdGVEYXRhOiBhbnlcbiAgICAgIGxldCBwbGF5ZXJSb2xlOiAncGxheWVyX2EnIHwgJ3BsYXllcl9iJ1xuXG4gICAgICBpZiAoIWN1cnJlbnRSb29tLnBsYXllcl9hX2lkKSB7XG4gICAgICAgIHVwZGF0ZURhdGEgPSB7IFxuICAgICAgICAgIHBsYXllcl9hX2lkOiBhY3R1YWxVc2VySWQsXG4gICAgICAgICAgcGxheWVyX2FfcmVhZHk6IGZhbHNlLFxuICAgICAgICAgIHBsYXllcl9hX25hbWU6IHBsYXllck5hbWUgfHwgbnVsbFxuICAgICAgICB9XG4gICAgICAgIHBsYXllclJvbGUgPSAncGxheWVyX2EnXG4gICAgICAgIGNvbnNvbGUubG9nKCfwn46tIFJPT00gU0VSVklDRSAtIEpvaW5pbmcgYXMgUGxheWVyIEEnKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdXBkYXRlRGF0YSA9IHsgXG4gICAgICAgICAgcGxheWVyX2JfaWQ6IGFjdHVhbFVzZXJJZCxcbiAgICAgICAgICBwbGF5ZXJfYl9yZWFkeTogZmFsc2UsXG4gICAgICAgICAgcGxheWVyX2JfbmFtZTogcGxheWVyTmFtZSB8fCBudWxsXG4gICAgICAgIH1cbiAgICAgICAgcGxheWVyUm9sZSA9ICdwbGF5ZXJfYidcbiAgICAgICAgY29uc29sZS5sb2coJ/Cfjq0gUk9PTSBTRVJWSUNFIC0gSm9pbmluZyBhcyBQbGF5ZXIgQicpXG4gICAgICB9XG5cbiAgICAgIC8vIFVwZGF0ZSB0aGUgcm9vbVxuICAgICAgY29uc3QgeyBkYXRhOiB1cGRhdGVkUm9vbSwgZXJyb3I6IHVwZGF0ZUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgncm9vbXMnKVxuICAgICAgICAudXBkYXRlKHVwZGF0ZURhdGEpXG4gICAgICAgIC5lcSgnaWQnLCByb29tSWQpXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuc2luZ2xlKClcblxuICAgICAgaWYgKHVwZGF0ZUVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBST09NIFNFUlZJQ0UgLSBFcnJvciB1cGRhdGluZyByb29tOicsIHVwZGF0ZUVycm9yKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBqb2luIHJvb206ICR7dXBkYXRlRXJyb3IubWVzc2FnZX1gKVxuICAgICAgfVxuXG4gICAgICBpZiAoIXVwZGF0ZWRSb29tKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIHVwZGF0ZSByb29tIC0gbm8gZGF0YSByZXR1cm5lZCcpXG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKCfinIUgUk9PTSBTRVJWSUNFIC0gU3VjY2Vzc2Z1bGx5IGpvaW5lZCBhczonLCBwbGF5ZXJSb2xlKVxuICAgICAgcmV0dXJuIHsgcm9vbTogdXBkYXRlZFJvb20sIHBsYXllclJvbGUgfVxuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBST09NIFNFUlZJQ0UgLSBKb2luIHJvb20gZXJyb3I6JywgZXJyb3IpXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfSxcblxuICAvLyBSZWFkeSB1cCBmb3IgdGhlIGdhbWVcbiAgLy8gVXBkYXRlIHRoZSByZWFkeVVwIGZ1bmN0aW9uIGluIHNyYy9saWIvcm9vbVNlcnZpY2UudHNcbi8vIFJlcGxhY2UgdGhlIGV4aXN0aW5nIHJlYWR5VXAgZnVuY3Rpb24gd2l0aCB0aGlzIHZlcnNpb246XG5cbiAgLy8gVXBkYXRlIHRoZSByZWFkeVVwIGZ1bmN0aW9uIGluIHNyYy9saWIvcm9vbVNlcnZpY2UudHNcbi8vIFJlcGxhY2UgdGhlIGV4aXN0aW5nIHJlYWR5VXAgZnVuY3Rpb24gd2l0aCB0aGlzIHZlcnNpb246XG5cbmFzeW5jIHJlYWR5VXAocm9vbUlkOiBzdHJpbmcpOiBQcm9taXNlPFJvb20gfCBudWxsPiB7XG4gIHRyeSB7XG4gICAgLy8gR2V0IHVzZXIgSUQgZnJvbSByb2xlIG1hbmFnZXIgZm9yIGNvbnNpc3RlbmN5XG4gICAgbGV0IHVzZXJJZCA9IGF3YWl0IHRoaXMuZ2V0VXNlcklkKClcbiAgICBpZiAoIXVzZXJJZCkge1xuICAgICAgdXNlcklkID0gdGhpcy5nZXRTZXNzaW9uSWQoKVxuICAgIH1cbiAgICBcbiAgICAvLyBWYWxpZGF0ZSBVVUlEIGZvcm1hdFxuICAgIGlmICghaXNWYWxpZFVVSUQodXNlcklkKSkge1xuICAgICAgY29uc29sZS5lcnJvcign4p2MIFJPT00gU0VSVklDRSAtIEludmFsaWQgVVVJRCBmb3JtYXQgaW4gcmVhZHlVcDonLCB1c2VySWQpXG4gICAgICB1c2VySWQgPSBnZW5lcmF0ZVVVSUQoKVxuICAgICAgY29uc29sZS5sb2coJ+KchSBST09NIFNFUlZJQ0UgLSBHZW5lcmF0ZWQgbmV3IHZhbGlkIFVVSUQgZm9yIHJlYWR5VXA6JywgdXNlcklkLnNsaWNlKC04KSlcbiAgICB9XG4gICAgXG4gICAgY29uc29sZS5sb2coJ/CfmoAgUk9PTSBTRVJWSUNFIC0gUmVhZHkgdXAgd2l0aCB1c2VyOicsIHVzZXJJZC5zbGljZSgtOCkpXG4gICAgXG4gICAgLy8gR2V0IGN1cnJlbnQgcm9vbSBzdGF0ZVxuICAgIGNvbnN0IHsgZGF0YTogcm9vbSwgZXJyb3I6IGZldGNoRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgncm9vbXMnKVxuICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAuZXEoJ2lkJywgcm9vbUlkKVxuICAgICAgLnNpbmdsZSgpXG5cbiAgICBpZiAoZmV0Y2hFcnJvciB8fCAhcm9vbSkge1xuICAgICAgY29uc29sZS5lcnJvcign4p2MIFJPT00gU0VSVklDRSAtIEVycm9yIGZldGNoaW5nIHJvb20gZm9yIHJlYWR5IHVwOicsIGZldGNoRXJyb3IpXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Jvb20gbm90IGZvdW5kJylcbiAgICB9XG5cbiAgICAvLyBEZXRlcm1pbmUgd2hpY2ggcGxheWVyIGlzIHJlYWR5LWluZyB1cFxuICAgIGxldCB1cGRhdGVEYXRhOiBhbnkgPSB7fVxuICAgIFxuICAgIGlmIChyb29tLnBsYXllcl9hX2lkID09PSB1c2VySWQpIHtcbiAgICAgIHVwZGF0ZURhdGEucGxheWVyX2FfcmVhZHkgPSB0cnVlXG4gICAgICBjb25zb2xlLmxvZygn8J+FsO+4jyBST09NIFNFUlZJQ0UgLSBQbGF5ZXIgQSByZWFkeWluZyB1cCcpXG4gICAgfSBlbHNlIGlmIChyb29tLnBsYXllcl9iX2lkID09PSB1c2VySWQpIHtcbiAgICAgIHVwZGF0ZURhdGEucGxheWVyX2JfcmVhZHkgPSB0cnVlXG4gICAgICBjb25zb2xlLmxvZygn8J+Fse+4jyBST09NIFNFUlZJQ0UgLSBQbGF5ZXIgQiByZWFkeWluZyB1cCcpXG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBST09NIFNFUlZJQ0UgLSBVc2VyIG5vdCBmb3VuZCBpbiByb29tOicsIHtcbiAgICAgICAgdXNlcklkOiB1c2VySWQuc2xpY2UoLTgpLFxuICAgICAgICByb29tUGxheWVyQTogcm9vbS5wbGF5ZXJfYV9pZD8uc2xpY2UoLTgpLFxuICAgICAgICByb29tUGxheWVyQjogcm9vbS5wbGF5ZXJfYl9pZD8uc2xpY2UoLTgpXG4gICAgICB9KVxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdZb3UgYXJlIG5vdCBpbiB0aGlzIHJvb20nKVxuICAgIH1cblxuICAgIC8vIENoZWNrIGlmIGJvdGggcGxheWVycyB3aWxsIGJlIHJlYWR5IGFmdGVyIHRoaXMgdXBkYXRlXG4gICAgY29uc3QgYm90aFJlYWR5ID0gKHJvb20ucGxheWVyX2FfaWQgPT09IHVzZXJJZCA/IHRydWUgOiByb29tLnBsYXllcl9hX3JlYWR5KSAmJiBcbiAgICAgICAgICAgICAgICAgICAgKHJvb20ucGxheWVyX2JfaWQgPT09IHVzZXJJZCA/IHRydWUgOiByb29tLnBsYXllcl9iX3JlYWR5KVxuXG4gICAgY29uc29sZS5sb2coJ+KchSBST09NIFNFUlZJQ0UgLSBCb3RoIHBsYXllcnMgcmVhZHkgYWZ0ZXIgdXBkYXRlOicsIGJvdGhSZWFkeSlcblxuICAgIC8vIEZJWEVEOiBTZXQgdG8gJ3JlYWR5X3RvX3N0YXJ0JyB3aGVuIGJvdGggcGxheWVycyBhcmUgcmVhZHlcbiAgICAvLyBUaGlzIHRyaWdnZXJzIHRoZSAxMi1zZWNvbmQgY291bnRkb3duIGluIEdhbWVMb2JieVxuICAgIGlmIChib3RoUmVhZHkgJiYgcm9vbS5wbGF5ZXJfYV9pZCAmJiByb29tLnBsYXllcl9iX2lkKSB7XG4gICAgICB1cGRhdGVEYXRhLnN0YXR1cyA9ICdyZWFkeV90b19zdGFydCcgLy8gVGhpcyB0cmlnZ2VycyB0aGUgR2FtZUxvYmJ5IGNvdW50ZG93blxuICAgICAgY29uc29sZS5sb2coJ/Cfjq8gUk9PTSBTRVJWSUNFIC0gU2V0dGluZyByb29tIHRvIHJlYWR5X3RvX3N0YXJ0IHN0YXR1cyAodHJpZ2dlcnMgMTJzIGNvdW50ZG93biknKVxuICAgIH1cblxuICAgIC8vIFVwZGF0ZSB0aGUgcm9vbVxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3I6IHVwZGF0ZUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ3Jvb21zJylcbiAgICAgIC51cGRhdGUodXBkYXRlRGF0YSlcbiAgICAgIC5lcSgnaWQnLCByb29tSWQpXG4gICAgICAuc2VsZWN0KClcbiAgICAgIC5zaW5nbGUoKVxuXG4gICAgaWYgKHVwZGF0ZUVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgUk9PTSBTRVJWSUNFIC0gRXJyb3IgcmVhZHlpbmcgdXA6JywgdXBkYXRlRXJyb3IpXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byByZWFkeSB1cDogJHt1cGRhdGVFcnJvci5tZXNzYWdlfWApXG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coJ+KchSBST09NIFNFUlZJQ0UgLSBTdWNjZXNzZnVsbHkgcmVhZGllZCB1cCcpXG4gICAgcmV0dXJuIGRhdGFcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfinYwgUk9PTSBTRVJWSUNFIC0gUmVhZHkgdXAgZXJyb3I6JywgZXJyb3IpXG4gICAgdGhyb3cgZXJyb3JcbiAgfVxufSxcblxuLy8gQWxzbyB1cGRhdGUgdGhlIHN0YXJ0R2FtZVdpdGhTaWRlU2VsZWN0aW9uIGZ1bmN0aW9uIHRvIGVuc3VyZSBpdCBvbmx5IGdldHMgY2FsbGVkIGFmdGVyIHRoZSBmdWxsIGNvdW50ZG93bjpcblxuYXN5bmMgc3RhcnRHYW1lV2l0aFNpZGVTZWxlY3Rpb24ocm9vbUlkOiBzdHJpbmcpOiBQcm9taXNlPFJvb20gfCBudWxsPiB7XG4gIHRyeSB7XG4gICAgY29uc29sZS5sb2coJ/Cfjq4gUk9PTSBTRVJWSUNFIC0gU3RhcnRpbmcgZ2FtZSB3aXRoIHNpZGUgc2VsZWN0aW9uIGZvciByb29tOicsIHJvb21JZC5zbGljZSgtOCkpXG4gICAgXG4gICAgY29uc3QgZGVhZGxpbmUgPSBuZXcgRGF0ZShEYXRlLm5vdygpICsgMTAwMDApIC8vIDEwIHNlY29uZHMgZnJvbSBub3cgZm9yIHNpZGUgc2VsZWN0aW9uXG4gICAgXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdyb29tcycpXG4gICAgICAudXBkYXRlKHsgXG4gICAgICAgIHN0YXR1czogJ2RlYmF0aW5nJywgLy8gVGhpcyBtb3ZlcyBmcm9tICdyZWFkeV90b19zdGFydCcgdG8gJ2RlYmF0aW5nJ1xuICAgICAgICBjdXJyZW50X3BoYXNlOiAnc2lkZV9zZWxlY3Rpb24nLCAvLyBTdGFydCB3aXRoIHNpZGUgc2VsZWN0aW9uXG4gICAgICAgIHNpZGVfc2VsZWN0aW9uX2RlYWRsaW5lOiBkZWFkbGluZS50b0lTT1N0cmluZygpLFxuICAgICAgICBwaGFzZV9zdGFydF90aW1lOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIHBoYXNlX2R1cmF0aW9uOiAxMCAvLyAxMCBzZWNvbmRzIGZvciBzaWRlIHNlbGVjdGlvblxuICAgICAgfSlcbiAgICAgIC5lcSgnaWQnLCByb29tSWQpXG4gICAgICAuc2VsZWN0KClcbiAgICAgIC5zaW5nbGUoKVxuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgUk9PTSBTRVJWSUNFIC0gRXJyb3Igc3RhcnRpbmcgZ2FtZSB3aXRoIHNpZGUgc2VsZWN0aW9uOicsIGVycm9yKVxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gc3RhcnQgZ2FtZTogJHtlcnJvci5tZXNzYWdlfWApXG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coJ+KchSBST09NIFNFUlZJQ0UgLSBHYW1lIHN0YXJ0ZWQgd2l0aCBzaWRlIHNlbGVjdGlvbiBzdWNjZXNzZnVsbHknKVxuICAgIHJldHVybiBkYXRhXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign4p2MIFJPT00gU0VSVklDRSAtIFN0YXJ0IGdhbWUgd2l0aCBzaWRlIHNlbGVjdGlvbiBlcnJvcjonLCBlcnJvcilcbiAgICB0aHJvdyBlcnJvclxuICB9XG59LFxuXG4gIC8vIFN1Ym1pdCBzaWRlIHZvdGVcbiAgYXN5bmMgc3VibWl0U2lkZVZvdGUocm9vbUlkOiBzdHJpbmcsIHNpZGU6ICdwcm8nIHwgJ2NvbicpOiBQcm9taXNlPFJvb20gfCBudWxsPiB7XG4gICAgdHJ5IHtcbiAgICAgIGxldCB1c2VySWQgPSBhd2FpdCB0aGlzLmdldFVzZXJJZCgpXG4gICAgICBpZiAoIXVzZXJJZCkge1xuICAgICAgICB1c2VySWQgPSB0aGlzLmdldFNlc3Npb25JZCgpXG4gICAgICB9XG5cbiAgICAgIC8vIFZhbGlkYXRlIFVVSUQgZm9ybWF0XG4gICAgICBpZiAoIWlzVmFsaWRVVUlEKHVzZXJJZCkpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcign4p2MIFJPT00gU0VSVklDRSAtIEludmFsaWQgVVVJRCBmb3JtYXQgaW4gc3VibWl0U2lkZVZvdGU6JywgdXNlcklkKVxuICAgICAgICB1c2VySWQgPSBnZW5lcmF0ZVVVSUQoKVxuICAgICAgICBjb25zb2xlLmxvZygn4pyFIFJPT00gU0VSVklDRSAtIEdlbmVyYXRlZCBuZXcgdmFsaWQgVVVJRCBmb3Igc3VibWl0U2lkZVZvdGU6JywgdXNlcklkLnNsaWNlKC04KSlcbiAgICAgIH1cblxuICAgICAgY29uc29sZS5sb2coJ/Cfl7PvuI8gUk9PTSBTRVJWSUNFIC0gU3VibWl0dGluZyB2b3RlOicsIHtcbiAgICAgICAgdXNlcklkOiB1c2VySWQuc2xpY2UoLTgpLFxuICAgICAgICBzaWRlLFxuICAgICAgICByb29tSWQ6IHJvb21JZC5zbGljZSgtOClcbiAgICAgIH0pXG5cbiAgICAgIC8vIEdldCBjdXJyZW50IHJvb20gdG8gZGV0ZXJtaW5lIHBsYXllciByb2xlXG4gICAgICBjb25zdCB7IGRhdGE6IHJvb20sIGVycm9yOiBmZXRjaEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgncm9vbXMnKVxuICAgICAgICAuc2VsZWN0KCcqJylcbiAgICAgICAgLmVxKCdpZCcsIHJvb21JZClcbiAgICAgICAgLnNpbmdsZSgpXG5cbiAgICAgIGlmIChmZXRjaEVycm9yIHx8ICFyb29tKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignUm9vbSBub3QgZm91bmQnKVxuICAgICAgfVxuXG4gICAgICBsZXQgdXBkYXRlRGF0YTogYW55ID0ge31cbiAgICAgIFxuICAgICAgaWYgKHJvb20ucGxheWVyX2FfaWQgPT09IHVzZXJJZCkge1xuICAgICAgICB1cGRhdGVEYXRhLnBsYXllcl9hX3NpZGVfdm90ZSA9IHNpZGVcbiAgICAgICAgY29uc29sZS5sb2coJ/CfhbDvuI8gUk9PTSBTRVJWSUNFIC0gUGxheWVyIEEgdm90ZWQgZm9yOicsIHNpZGUpXG4gICAgICB9IGVsc2UgaWYgKHJvb20ucGxheWVyX2JfaWQgPT09IHVzZXJJZCkge1xuICAgICAgICB1cGRhdGVEYXRhLnBsYXllcl9iX3NpZGVfdm90ZSA9IHNpZGVcbiAgICAgICAgY29uc29sZS5sb2coJ/CfhbHvuI8gUk9PTSBTRVJWSUNFIC0gUGxheWVyIEIgdm90ZWQgZm9yOicsIHNpZGUpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgUk9PTSBTRVJWSUNFIC0gVXNlciBub3QgaW4gcm9vbSBmb3Igdm90aW5nOicsIHtcbiAgICAgICAgICB1c2VySWQ6IHVzZXJJZC5zbGljZSgtOCksXG4gICAgICAgICAgcm9vbVBsYXllckE6IHJvb20ucGxheWVyX2FfaWQ/LnNsaWNlKC04KSxcbiAgICAgICAgICByb29tUGxheWVyQjogcm9vbS5wbGF5ZXJfYl9pZD8uc2xpY2UoLTgpXG4gICAgICAgIH0pXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignWW91IGFyZSBub3QgaW4gdGhpcyByb29tJylcbiAgICAgIH1cblxuICAgICAgLy8gVXBkYXRlIHRoZSByb29tIHdpdGggdGhlIHZvdGVcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3I6IHVwZGF0ZUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgncm9vbXMnKVxuICAgICAgICAudXBkYXRlKHVwZGF0ZURhdGEpXG4gICAgICAgIC5lcSgnaWQnLCByb29tSWQpXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuc2luZ2xlKClcblxuICAgICAgaWYgKHVwZGF0ZUVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBST09NIFNFUlZJQ0UgLSBFcnJvciBzdWJtaXR0aW5nIHZvdGU6JywgdXBkYXRlRXJyb3IpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIHN1Ym1pdCB2b3RlOiAke3VwZGF0ZUVycm9yLm1lc3NhZ2V9YClcbiAgICAgIH1cblxuICAgICAgY29uc29sZS5sb2coJ+KchSBST09NIFNFUlZJQ0UgLSBWb3RlIHN1Ym1pdHRlZCBzdWNjZXNzZnVsbHknKVxuICAgICAgcmV0dXJuIGRhdGFcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign4p2MIFJPT00gU0VSVklDRSAtIFN1Ym1pdCBzaWRlIHZvdGUgZXJyb3I6JywgZXJyb3IpXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfSxcblxuICAvLyBDYWxjdWxhdGUgZmluYWwgc2lkZSBhc3NpZ25tZW50cyBhZnRlciB2b3RpbmcgcGVyaW9kXG4gIGFzeW5jIGZpbmFsaXplU2lkZVNlbGVjdGlvbihyb29tSWQ6IHN0cmluZyk6IFByb21pc2U8Um9vbSB8IG51bGw+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBkYXRhOiByb29tLCBlcnJvcjogZmV0Y2hFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3Jvb21zJylcbiAgICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAgIC5lcSgnaWQnLCByb29tSWQpXG4gICAgICAgIC5zaW5nbGUoKVxuXG4gICAgICBpZiAoZmV0Y2hFcnJvciB8fCAhcm9vbSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Jvb20gbm90IGZvdW5kJylcbiAgICAgIH1cblxuICAgICAgbGV0IHBsYXllckFTaWRlOiAncHJvJyB8ICdjb24nXG4gICAgICBsZXQgcGxheWVyQlNpZGU6ICdwcm8nIHwgJ2NvbidcblxuICAgICAgY29uc29sZS5sb2coJ/Cfjq8gUk9PTSBTRVJWSUNFIC0gRmluYWxpemluZyBzaWRlIHNlbGVjdGlvbjonLCB7XG4gICAgICAgIHBsYXllckFWb3RlOiByb29tLnBsYXllcl9hX3NpZGVfdm90ZSxcbiAgICAgICAgcGxheWVyQlZvdGU6IHJvb20ucGxheWVyX2Jfc2lkZV92b3RlXG4gICAgICB9KVxuXG4gICAgICAvLyBBcHBseSBzaWRlIGFzc2lnbm1lbnQgbG9naWNcbiAgICAgIGlmIChyb29tLnBsYXllcl9hX3NpZGVfdm90ZSAmJiByb29tLnBsYXllcl9iX3NpZGVfdm90ZSkge1xuICAgICAgICBpZiAocm9vbS5wbGF5ZXJfYV9zaWRlX3ZvdGUgPT09IHJvb20ucGxheWVyX2Jfc2lkZV92b3RlKSB7XG4gICAgICAgICAgLy8gQm90aCBjaG9zZSBzYW1lIHNpZGUgLSByYW5kb20gYXNzaWdubWVudFxuICAgICAgICAgIGlmIChNYXRoLnJhbmRvbSgpID4gMC41KSB7XG4gICAgICAgICAgICBwbGF5ZXJBU2lkZSA9ICdwcm8nXG4gICAgICAgICAgICBwbGF5ZXJCU2lkZSA9ICdjb24nXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHBsYXllckFTaWRlID0gJ2NvbidcbiAgICAgICAgICAgIHBsYXllckJTaWRlID0gJ3BybydcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc29sZS5sb2coJ/CfjrIgUk9PTSBTRVJWSUNFIC0gUmFuZG9tIGFzc2lnbm1lbnQgKGJvdGggY2hvc2Ugc2FtZSBzaWRlKScpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gRGlmZmVyZW50IHNpZGVzIC0gaG9ub3IgdGhlaXIgY2hvaWNlc1xuICAgICAgICAgIHBsYXllckFTaWRlID0gcm9vbS5wbGF5ZXJfYV9zaWRlX3ZvdGVcbiAgICAgICAgICBwbGF5ZXJCU2lkZSA9IHJvb20ucGxheWVyX2Jfc2lkZV92b3RlXG4gICAgICAgICAgY29uc29sZS5sb2coJ+KchSBST09NIFNFUlZJQ0UgLSBIb25vcmVkIGRpZmZlcmVudCBjaG9pY2VzJylcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChyb29tLnBsYXllcl9hX3NpZGVfdm90ZSAmJiAhcm9vbS5wbGF5ZXJfYl9zaWRlX3ZvdGUpIHtcbiAgICAgICAgLy8gT25seSBBIHZvdGVkIC0gQSBnZXRzIGNob2ljZSwgQiBnZXRzIG9wcG9zaXRlXG4gICAgICAgIHBsYXllckFTaWRlID0gcm9vbS5wbGF5ZXJfYV9zaWRlX3ZvdGVcbiAgICAgICAgcGxheWVyQlNpZGUgPSByb29tLnBsYXllcl9hX3NpZGVfdm90ZSA9PT0gJ3BybycgPyAnY29uJyA6ICdwcm8nXG4gICAgICAgIGNvbnNvbGUubG9nKCfwn4Ww77iPIFJPT00gU0VSVklDRSAtIE9ubHkgUGxheWVyIEEgdm90ZWQnKVxuICAgICAgfSBlbHNlIGlmICghcm9vbS5wbGF5ZXJfYV9zaWRlX3ZvdGUgJiYgcm9vbS5wbGF5ZXJfYl9zaWRlX3ZvdGUpIHtcbiAgICAgICAgLy8gT25seSBCIHZvdGVkIC0gQiBnZXRzIGNob2ljZSwgQSBnZXRzIG9wcG9zaXRlXG4gICAgICAgIHBsYXllckJTaWRlID0gcm9vbS5wbGF5ZXJfYl9zaWRlX3ZvdGVcbiAgICAgICAgcGxheWVyQVNpZGUgPSByb29tLnBsYXllcl9iX3NpZGVfdm90ZSA9PT0gJ3BybycgPyAnY29uJyA6ICdwcm8nXG4gICAgICAgIGNvbnNvbGUubG9nKCfwn4Wx77iPIFJPT00gU0VSVklDRSAtIE9ubHkgUGxheWVyIEIgdm90ZWQnKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gTm9ib2R5IHZvdGVkIC0gcmFuZG9tIGFzc2lnbm1lbnRcbiAgICAgICAgaWYgKE1hdGgucmFuZG9tKCkgPiAwLjUpIHtcbiAgICAgICAgICBwbGF5ZXJBU2lkZSA9ICdwcm8nXG4gICAgICAgICAgcGxheWVyQlNpZGUgPSAnY29uJ1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHBsYXllckFTaWRlID0gJ2NvbidcbiAgICAgICAgICBwbGF5ZXJCU2lkZSA9ICdwcm8nXG4gICAgICAgIH1cbiAgICAgICAgY29uc29sZS5sb2coJ/CfjrIgUk9PTSBTRVJWSUNFIC0gUmFuZG9tIGFzc2lnbm1lbnQgKG5vIHZvdGVzKScpXG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKCfwn46vIFJPT00gU0VSVklDRSAtIEZpbmFsIHNpZGUgYXNzaWdubWVudHM6JywgeyBwbGF5ZXJBU2lkZSwgcGxheWVyQlNpZGUgfSlcblxuICAgICAgLy8gVXBkYXRlIHJvb20gd2l0aCBmaW5hbCBhc3NpZ25tZW50cyBhbmQgbW92ZSB0byBvcGVuaW5nIHByZXAgcGhhc2VcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3I6IHVwZGF0ZUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgncm9vbXMnKVxuICAgICAgICAudXBkYXRlKHtcbiAgICAgICAgICBwbGF5ZXJfYV9zaWRlOiBwbGF5ZXJBU2lkZSxcbiAgICAgICAgICBwbGF5ZXJfYl9zaWRlOiBwbGF5ZXJCU2lkZSxcbiAgICAgICAgICBjdXJyZW50X3BoYXNlOiAnb3BlbmluZ19wcmVwJyxcbiAgICAgICAgICBwaGFzZV9zdGFydF90aW1lOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgcGhhc2VfZHVyYXRpb246IDMwIC8vIDMwIHNlY29uZHMgZm9yIG9wZW5pbmcgcHJlcFxuICAgICAgICB9KVxuICAgICAgICAuZXEoJ2lkJywgcm9vbUlkKVxuICAgICAgICAuc2VsZWN0KClcbiAgICAgICAgLnNpbmdsZSgpXG5cbiAgICAgIGlmICh1cGRhdGVFcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgUk9PTSBTRVJWSUNFIC0gRXJyb3IgZmluYWxpemluZyBzaWRlIHNlbGVjdGlvbjonLCB1cGRhdGVFcnJvcilcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZmluYWxpemUgc2lkZXM6ICR7dXBkYXRlRXJyb3IubWVzc2FnZX1gKVxuICAgICAgfVxuXG4gICAgICBjb25zb2xlLmxvZygn4pyFIFJPT00gU0VSVklDRSAtIFNpZGUgc2VsZWN0aW9uIGZpbmFsaXplZCcpXG4gICAgICByZXR1cm4gZGF0YVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgUk9PTSBTRVJWSUNFIC0gRmluYWxpemUgc2lkZSBzZWxlY3Rpb24gZXJyb3I6JywgZXJyb3IpXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfSxcblxuICAvLyBTZW5kIGEgY2hhdCBtZXNzYWdlIGR1cmluZyBkZWJhdGVcbiAgYXN5bmMgc2VuZE1lc3NhZ2UoXG4gICAgcm9vbUlkOiBzdHJpbmcsIFxuICAgIGNvbnRlbnQ6IHN0cmluZywgXG4gICAgcGhhc2U6IHN0cmluZywgXG4gICAgcGxheWVyU2lkZTogJ3BybycgfCAnY29uJyxcbiAgICBwbGF5ZXJSb2xlOiAncGxheWVyX2EnIHwgJ3BsYXllcl9iJ1xuICApOiBQcm9taXNlPE1lc3NhZ2UgfCBudWxsPiB7XG4gICAgdHJ5IHtcbiAgICAgIGxldCB1c2VySWQgPSBhd2FpdCB0aGlzLmdldFVzZXJJZCgpXG4gICAgICBpZiAoIXVzZXJJZCkge1xuICAgICAgICB1c2VySWQgPSB0aGlzLmdldFNlc3Npb25JZCgpXG4gICAgICB9XG5cbiAgICAgIC8vIFZhbGlkYXRlIFVVSUQgZm9ybWF0XG4gICAgICBpZiAoIWlzVmFsaWRVVUlEKHVzZXJJZCkpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcign4p2MIFJPT00gU0VSVklDRSAtIEludmFsaWQgVVVJRCBmb3JtYXQgaW4gc2VuZE1lc3NhZ2U6JywgdXNlcklkKVxuICAgICAgICB1c2VySWQgPSBnZW5lcmF0ZVVVSUQoKVxuICAgICAgICBjb25zb2xlLmxvZygn4pyFIFJPT00gU0VSVklDRSAtIEdlbmVyYXRlZCBuZXcgdmFsaWQgVVVJRCBmb3Igc2VuZE1lc3NhZ2U6JywgdXNlcklkLnNsaWNlKC04KSlcbiAgICAgIH1cblxuICAgICAgY29uc29sZS5sb2coJ/CfkqwgUk9PTSBTRVJWSUNFIC0gU2VuZGluZyBtZXNzYWdlOicsIHtcbiAgICAgICAgcm9vbUlkOiByb29tSWQuc2xpY2UoLTgpLFxuICAgICAgICB1c2VySWQ6IHVzZXJJZC5zbGljZSgtOCksXG4gICAgICAgIHBoYXNlLFxuICAgICAgICBwbGF5ZXJTaWRlLFxuICAgICAgICBjb250ZW50TGVuZ3RoOiBjb250ZW50Lmxlbmd0aFxuICAgICAgfSlcblxuICAgICAgLy8gR2V0IHRoZSByb29tIHRvIGZpbmQgdGhlIHBsYXllcidzIG5hbWVcbiAgICAgIGNvbnN0IHsgZGF0YTogcm9vbSB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3Jvb21zJylcbiAgICAgICAgLnNlbGVjdCgncGxheWVyX2FfbmFtZSwgcGxheWVyX2JfbmFtZSwgcGxheWVyX2FfaWQsIHBsYXllcl9iX2lkJylcbiAgICAgICAgLmVxKCdpZCcsIHJvb21JZClcbiAgICAgICAgLnNpbmdsZSgpXG5cbiAgICAgIC8vIERldGVybWluZSBzZW5kZXIgbmFtZSAtIHVzZSBzdG9yZWQgbmFtZSBvciBmYWxsYmFja1xuICAgICAgbGV0IHNlbmRlck5hbWUgPSBgJHtwbGF5ZXJSb2xlID09PSAncGxheWVyX2EnID8gJ1BsYXllciBBJyA6ICdQbGF5ZXIgQid9ICgke3BsYXllclNpZGUudG9VcHBlckNhc2UoKX0pYFxuICAgICAgXG4gICAgICBpZiAocm9vbSkge1xuICAgICAgICBjb25zdCBzdG9yZWROYW1lID0gcGxheWVyUm9sZSA9PT0gJ3BsYXllcl9hJyA/IHJvb20ucGxheWVyX2FfbmFtZSA6IHJvb20ucGxheWVyX2JfbmFtZVxuICAgICAgICBpZiAoc3RvcmVkTmFtZSkge1xuICAgICAgICAgIHNlbmRlck5hbWUgPSBgJHtzdG9yZWROYW1lfSAoJHtwbGF5ZXJTaWRlLnRvVXBwZXJDYXNlKCl9KWBcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBjb25zdCBtZXNzYWdlRGF0YSA9IHtcbiAgICAgICAgcm9vbV9pZDogcm9vbUlkLFxuICAgICAgICB1c2VyX2lkOiB1c2VySWQsXG4gICAgICAgIHNlbmRlcl9uYW1lOiBzZW5kZXJOYW1lLFxuICAgICAgICBjb250ZW50OiBjb250ZW50LFxuICAgICAgICBwaGFzZTogcGhhc2UgYXMgJ3NpZGVfc2VsZWN0aW9uJyB8ICdvcGVuaW5nJyB8ICdyZWJ1dHRhbCcgfCAnY3Jvc3NmaXJlJyB8ICdmaW5hbCcgfCAnanVkZ2luZycsXG4gICAgICAgIHBsYXllcl9zaWRlOiBwbGF5ZXJTaWRlXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdtZXNzYWdlcycpXG4gICAgICAgIC5pbnNlcnQoW21lc3NhZ2VEYXRhXSlcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5zaW5nbGUoKVxuXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcign4p2MIFJPT00gU0VSVklDRSAtIEVycm9yIHNlbmRpbmcgbWVzc2FnZTonLCBlcnJvcilcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gc2VuZCBtZXNzYWdlOiAke2Vycm9yLm1lc3NhZ2V9YClcbiAgICAgIH1cblxuICAgICAgY29uc29sZS5sb2coJ+KchSBST09NIFNFUlZJQ0UgLSBNZXNzYWdlIHNlbnQgc3VjY2Vzc2Z1bGx5JylcbiAgICAgIHJldHVybiBkYXRhIGFzIE1lc3NhZ2VcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign4p2MIFJPT00gU0VSVklDRSAtIFNlbmQgbWVzc2FnZSBlcnJvcjonLCBlcnJvcilcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9LFxuXG4gIC8vIEdldCBhbGwgbWVzc2FnZXMgZm9yIGEgcm9vbVxuICBhc3luYyBnZXRNZXNzYWdlcyhyb29tSWQ6IHN0cmluZyk6IFByb21pc2U8TWVzc2FnZVtdPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKCfwn5OcIFJPT00gU0VSVklDRSAtIExvYWRpbmcgbWVzc2FnZXMgZm9yIHJvb206Jywgcm9vbUlkLnNsaWNlKC04KSlcblxuICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ21lc3NhZ2VzJylcbiAgICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAgIC5lcSgncm9vbV9pZCcsIHJvb21JZClcbiAgICAgICAgLm9yZGVyKCdjcmVhdGVkX2F0JywgeyBhc2NlbmRpbmc6IHRydWUgfSlcblxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBST09NIFNFUlZJQ0UgLSBFcnJvciBsb2FkaW5nIG1lc3NhZ2VzOicsIGVycm9yKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBsb2FkIG1lc3NhZ2VzOiAke2Vycm9yLm1lc3NhZ2V9YClcbiAgICAgIH1cblxuICAgICAgY29uc29sZS5sb2coJ+KchSBST09NIFNFUlZJQ0UgLSBMb2FkZWQgbWVzc2FnZXM6JywgZGF0YT8ubGVuZ3RoIHx8IDApXG4gICAgICByZXR1cm4gKGRhdGEgYXMgTWVzc2FnZVtdKSB8fCBbXVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgUk9PTSBTRVJWSUNFIC0gR2V0IG1lc3NhZ2VzIGVycm9yOicsIGVycm9yKVxuICAgICAgcmV0dXJuIFtdXG4gICAgfVxuICB9LFxuXG4gIC8vIFN1YnNjcmliZSB0byBuZXcgbWVzc2FnZXMgaW4gcmVhbC10aW1lXG4gIHN1YnNjcmliZVRvTWVzc2FnZXMocm9vbUlkOiBzdHJpbmcsIGNhbGxiYWNrOiAobWVzc2FnZTogTWVzc2FnZSkgPT4gdm9pZCkge1xuICAgIGNvbnNvbGUubG9nKCfwn5OhIFJPT00gU0VSVklDRSAtIFNldHRpbmcgdXAgbWVzc2FnZSBzdWJzY3JpcHRpb24gZm9yIHJvb206Jywgcm9vbUlkLnNsaWNlKC04KSlcbiAgICBcbiAgICBjb25zdCBjaGFubmVsID0gc3VwYWJhc2VcbiAgICAgIC5jaGFubmVsKGBtZXNzYWdlczoke3Jvb21JZH06JHtEYXRlLm5vdygpfWApXG4gICAgICAub24oXG4gICAgICAgICdwb3N0Z3Jlc19jaGFuZ2VzJyxcbiAgICAgICAge1xuICAgICAgICAgIGV2ZW50OiAnSU5TRVJUJyxcbiAgICAgICAgICBzY2hlbWE6ICdwdWJsaWMnLFxuICAgICAgICAgIHRhYmxlOiAnbWVzc2FnZXMnLFxuICAgICAgICAgIGZpbHRlcjogYHJvb21faWQ9ZXEuJHtyb29tSWR9YCxcbiAgICAgICAgfSxcbiAgICAgICAgKHBheWxvYWQ6IGFueSkgPT4ge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCfwn5KsIFJPT00gU0VSVklDRSAtIE5ldyBtZXNzYWdlIHJlY2VpdmVkOicsIHtcbiAgICAgICAgICAgIHNlbmRlcjogcGF5bG9hZC5uZXc/LnNlbmRlcl9uYW1lLFxuICAgICAgICAgICAgcGhhc2U6IHBheWxvYWQubmV3Py5waGFzZSxcbiAgICAgICAgICAgIHNpZGU6IHBheWxvYWQubmV3Py5wbGF5ZXJfc2lkZSxcbiAgICAgICAgICAgIGNvbnRlbnRMZW5ndGg6IHBheWxvYWQubmV3Py5jb250ZW50Py5sZW5ndGhcbiAgICAgICAgICB9KVxuICAgICAgICAgIFxuICAgICAgICAgIGlmIChwYXlsb2FkLm5ldykge1xuICAgICAgICAgICAgY2FsbGJhY2socGF5bG9hZC5uZXcgYXMgTWVzc2FnZSlcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIClcbiAgICAgIC5zdWJzY3JpYmUoKHN0YXR1czogc3RyaW5nLCBlcnJvcj86IEVycm9yKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfwn5OhIFJPT00gU0VSVklDRSAtIE1lc3NhZ2Ugc3Vic2NyaXB0aW9uIHN0YXR1czonLCBzdGF0dXMpXG4gICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBST09NIFNFUlZJQ0UgLSBNZXNzYWdlIHN1YnNjcmlwdGlvbiBlcnJvcjonLCBlcnJvcilcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKHN0YXR1cyA9PT0gJ1NVQlNDUklCRUQnKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ+KchSBST09NIFNFUlZJQ0UgLSBTdWNjZXNzZnVsbHkgc3Vic2NyaWJlZCB0byBtZXNzYWdlIHVwZGF0ZXMnKVxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgcmV0dXJuIGNoYW5uZWxcbiAgfSxcblxuICAvLyBVbnJlYWR5XG4gIGFzeW5jIHVucmVhZHkocm9vbUlkOiBzdHJpbmcpOiBQcm9taXNlPFJvb20gfCBudWxsPiB7XG4gICAgdHJ5IHtcbiAgICAgIGxldCB1c2VySWQgPSBhd2FpdCB0aGlzLmdldFVzZXJJZCgpXG4gICAgICBpZiAoIXVzZXJJZCkge1xuICAgICAgICB1c2VySWQgPSB0aGlzLmdldFNlc3Npb25JZCgpXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIFZhbGlkYXRlIFVVSUQgZm9ybWF0XG4gICAgICBpZiAoIWlzVmFsaWRVVUlEKHVzZXJJZCkpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcign4p2MIFJPT00gU0VSVklDRSAtIEludmFsaWQgVVVJRCBmb3JtYXQgaW4gdW5yZWFkeTonLCB1c2VySWQpXG4gICAgICAgIHVzZXJJZCA9IGdlbmVyYXRlVVVJRCgpXG4gICAgICAgIGNvbnNvbGUubG9nKCfinIUgUk9PTSBTRVJWSUNFIC0gR2VuZXJhdGVkIG5ldyB2YWxpZCBVVUlEIGZvciB1bnJlYWR5OicsIHVzZXJJZC5zbGljZSgtOCkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgZGF0YTogcm9vbSwgZXJyb3I6IGZldGNoRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdyb29tcycpXG4gICAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgICAuZXEoJ2lkJywgcm9vbUlkKVxuICAgICAgICAuc2luZ2xlKClcblxuICAgICAgaWYgKGZldGNoRXJyb3IgfHwgIXJvb20pIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdSb29tIG5vdCBmb3VuZCcpXG4gICAgICB9XG5cbiAgICAgIGxldCB1cGRhdGVEYXRhOiBhbnkgPSB7fVxuICAgICAgXG4gICAgICBpZiAocm9vbS5wbGF5ZXJfYV9pZCA9PT0gdXNlcklkKSB7XG4gICAgICAgIHVwZGF0ZURhdGEucGxheWVyX2FfcmVhZHkgPSBmYWxzZVxuICAgICAgICBjb25zb2xlLmxvZygn8J+FsO+4jyBST09NIFNFUlZJQ0UgLSBQbGF5ZXIgQSB1bnJlYWR5aW5nJylcbiAgICAgIH0gZWxzZSBpZiAocm9vbS5wbGF5ZXJfYl9pZCA9PT0gdXNlcklkKSB7XG4gICAgICAgIHVwZGF0ZURhdGEucGxheWVyX2JfcmVhZHkgPSBmYWxzZVxuICAgICAgICBjb25zb2xlLmxvZygn8J+Fse+4jyBST09NIFNFUlZJQ0UgLSBQbGF5ZXIgQiB1bnJlYWR5aW5nJylcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignWW91IGFyZSBub3QgaW4gdGhpcyByb29tJylcbiAgICAgIH1cblxuICAgICAgLy8gUmVzZXQgdG8gd2FpdGluZyBzdGF0dXNcbiAgICAgIHVwZGF0ZURhdGEuc3RhdHVzID0gJ3dhaXRpbmcnXG4gICAgICB1cGRhdGVEYXRhLmN1cnJlbnRfcGhhc2UgPSBudWxsXG5cbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3I6IHVwZGF0ZUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgncm9vbXMnKVxuICAgICAgICAudXBkYXRlKHVwZGF0ZURhdGEpXG4gICAgICAgIC5lcSgnaWQnLCByb29tSWQpXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuc2luZ2xlKClcblxuICAgICAgaWYgKHVwZGF0ZUVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBST09NIFNFUlZJQ0UgLSBFcnJvciB1bnJlYWR5aW5nOicsIHVwZGF0ZUVycm9yKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byB1bnJlYWR5OiAke3VwZGF0ZUVycm9yLm1lc3NhZ2V9YClcbiAgICAgIH1cblxuICAgICAgY29uc29sZS5sb2coJ+KchSBST09NIFNFUlZJQ0UgLSBTdWNjZXNzZnVsbHkgdW5yZWFkaWVkJylcbiAgICAgIHJldHVybiBkYXRhXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBST09NIFNFUlZJQ0UgLSBVbnJlYWR5IGVycm9yOicsIGVycm9yKVxuICAgICAgdGhyb3cgZXJyb3JcbiAgICB9XG4gIH0sXG5cbiAgLy8gTGVhdmUgcm9vbVxuICBhc3luYyBsZWF2ZVJvb20ocm9vbUlkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICB0cnkge1xuICAgICAgbGV0IHVzZXJJZCA9IGF3YWl0IHRoaXMuZ2V0VXNlcklkKClcbiAgICAgIGlmICghdXNlcklkKSB7XG4gICAgICAgIHVzZXJJZCA9IHRoaXMuZ2V0U2Vzc2lvbklkKClcbiAgICAgIH1cblxuICAgICAgLy8gVmFsaWRhdGUgVVVJRCBmb3JtYXRcbiAgICAgIGlmICghaXNWYWxpZFVVSUQodXNlcklkKSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgUk9PTSBTRVJWSUNFIC0gSW52YWxpZCBVVUlEIGZvcm1hdCBpbiBsZWF2ZVJvb206JywgdXNlcklkKVxuICAgICAgICB1c2VySWQgPSBnZW5lcmF0ZVVVSUQoKVxuICAgICAgICBjb25zb2xlLmxvZygn4pyFIFJPT00gU0VSVklDRSAtIEdlbmVyYXRlZCBuZXcgdmFsaWQgVVVJRCBmb3IgbGVhdmVSb29tOicsIHVzZXJJZC5zbGljZSgtOCkpXG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKCfwn5qqIFJPT00gU0VSVklDRSAtIExlYXZpbmcgcm9vbTonLCB7XG4gICAgICAgIHJvb21JZDogcm9vbUlkLnNsaWNlKC04KSxcbiAgICAgICAgdXNlcklkOiB1c2VySWQuc2xpY2UoLTgpXG4gICAgICB9KVxuICAgICAgXG4gICAgICBjb25zdCB7IGRhdGE6IHJvb20sIGVycm9yOiBmZXRjaEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgncm9vbXMnKVxuICAgICAgICAuc2VsZWN0KCcqJylcbiAgICAgICAgLmVxKCdpZCcsIHJvb21JZClcbiAgICAgICAgLnNpbmdsZSgpXG5cbiAgICAgIGlmIChmZXRjaEVycm9yIHx8ICFyb29tKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignUm9vbSBub3QgZm91bmQnKVxuICAgICAgfVxuXG4gICAgICBsZXQgdXBkYXRlRGF0YTogYW55ID0ge31cbiAgICAgIFxuICAgICAgaWYgKHJvb20ucGxheWVyX2FfaWQgPT09IHVzZXJJZCkge1xuICAgICAgICB1cGRhdGVEYXRhLnBsYXllcl9hX2lkID0gbnVsbFxuICAgICAgICB1cGRhdGVEYXRhLnBsYXllcl9hX3JlYWR5ID0gZmFsc2VcbiAgICAgICAgdXBkYXRlRGF0YS5wbGF5ZXJfYV9zaWRlX3ZvdGUgPSBudWxsXG4gICAgICAgIHVwZGF0ZURhdGEucGxheWVyX2Ffc2lkZSA9IG51bGxcbiAgICAgICAgdXBkYXRlRGF0YS5wbGF5ZXJfYV9uYW1lID0gbnVsbFxuICAgICAgICBjb25zb2xlLmxvZygn8J+FsO+4jyBST09NIFNFUlZJQ0UgLSBQbGF5ZXIgQSBsZWF2aW5nJylcbiAgICAgIH0gZWxzZSBpZiAocm9vbS5wbGF5ZXJfYl9pZCA9PT0gdXNlcklkKSB7XG4gICAgICAgIHVwZGF0ZURhdGEucGxheWVyX2JfaWQgPSBudWxsXG4gICAgICAgIHVwZGF0ZURhdGEucGxheWVyX2JfcmVhZHkgPSBmYWxzZVxuICAgICAgICB1cGRhdGVEYXRhLnBsYXllcl9iX3NpZGVfdm90ZSA9IG51bGxcbiAgICAgICAgdXBkYXRlRGF0YS5wbGF5ZXJfYl9zaWRlID0gbnVsbFxuICAgICAgICB1cGRhdGVEYXRhLnBsYXllcl9iX25hbWUgPSBudWxsXG4gICAgICAgIGNvbnNvbGUubG9nKCfwn4Wx77iPIFJPT00gU0VSVklDRSAtIFBsYXllciBCIGxlYXZpbmcnKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdZb3UgYXJlIG5vdCBpbiB0aGlzIHJvb20nKVxuICAgICAgfVxuXG4gICAgICAvLyBSZXNldCByb29tIHN0YXR1cyB0byB3YWl0aW5nXG4gICAgICB1cGRhdGVEYXRhLnN0YXR1cyA9ICd3YWl0aW5nJ1xuICAgICAgdXBkYXRlRGF0YS5jdXJyZW50X3BoYXNlID0gbnVsbFxuXG4gICAgICBjb25zdCB7IGVycm9yOiB1cGRhdGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3Jvb21zJylcbiAgICAgICAgLnVwZGF0ZSh1cGRhdGVEYXRhKVxuICAgICAgICAuZXEoJ2lkJywgcm9vbUlkKVxuXG4gICAgICBpZiAodXBkYXRlRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcign4p2MIFJPT00gU0VSVklDRSAtIEVycm9yIGxlYXZpbmcgcm9vbTonLCB1cGRhdGVFcnJvcilcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gbGVhdmUgcm9vbTogJHt1cGRhdGVFcnJvci5tZXNzYWdlfWApXG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKCfinIUgUk9PTSBTRVJWSUNFIC0gU3VjY2Vzc2Z1bGx5IGxlZnQgcm9vbScpXG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgUk9PTSBTRVJWSUNFIC0gTGVhdmUgcm9vbSBlcnJvcjonLCBlcnJvcilcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9LFxuXG4gIC8vIEdldCByb29tIGRldGFpbHNcbiAgYXN5bmMgZ2V0Um9vbShyb29tSWQ6IHN0cmluZyk6IFByb21pc2U8Um9vbSB8IG51bGw+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3Jvb21zJylcbiAgICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAgIC5lcSgnaWQnLCByb29tSWQpXG4gICAgICAgIC5zaW5nbGUoKVxuXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgaWYgKGVycm9yLmNvZGUgPT09ICdQR1JTVDExNicpIHtcbiAgICAgICAgICByZXR1cm4gbnVsbCAvLyBSb29tIG5vdCBmb3VuZFxuICAgICAgICB9XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBST09NIFNFUlZJQ0UgLSBFcnJvciBmZXRjaGluZyByb29tOicsIGVycm9yKVxuICAgICAgICB0aHJvdyBlcnJvclxuICAgICAgfVxuXG4gICAgICByZXR1cm4gZGF0YVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgUk9PTSBTRVJWSUNFIC0gR2V0IHJvb20gZXJyb3I6JywgZXJyb3IpXG4gICAgICByZXR1cm4gbnVsbFxuICAgIH1cbiAgfSxcblxuICAvLyBTdGFydCBvcGVuaW5nIHByZXAgcGhhc2VcbiAgYXN5bmMgc3RhcnRPcGVuaW5nUHJlcChyb29tSWQ6IHN0cmluZyk6IFByb21pc2U8Um9vbSB8IG51bGw+IHtcbiAgICB0cnkge1xuICAgICAgY29uc29sZS5sb2coJ/Cfk50gUk9PTSBTRVJWSUNFIC0gU3RhcnRpbmcgb3BlbmluZyBwcmVwIHBoYXNlIGZvciByb29tOicsIHJvb21JZC5zbGljZSgtOCkpXG4gICAgICBcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdyb29tcycpXG4gICAgICAgIC51cGRhdGUoeyBcbiAgICAgICAgICBjdXJyZW50X3BoYXNlOiAnb3BlbmluZ19wcmVwJyxcbiAgICAgICAgICBwaGFzZV9zdGFydF90aW1lOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgcGhhc2VfZHVyYXRpb246IDMwIC8vIDMwIHNlY29uZHMgZm9yIHByZXBcbiAgICAgICAgfSlcbiAgICAgICAgLmVxKCdpZCcsIHJvb21JZClcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5zaW5nbGUoKVxuXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcign4p2MIFJPT00gU0VSVklDRSAtIEVycm9yIHN0YXJ0aW5nIG9wZW5pbmcgcHJlcDonLCBlcnJvcilcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gc3RhcnQgb3BlbmluZyBwcmVwOiAke2Vycm9yLm1lc3NhZ2V9YClcbiAgICAgIH1cblxuICAgICAgY29uc29sZS5sb2coJ+KchSBST09NIFNFUlZJQ0UgLSBPcGVuaW5nIHByZXAgc3RhcnRlZCBzdWNjZXNzZnVsbHknKVxuICAgICAgcmV0dXJuIGRhdGFcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign4p2MIFJPT00gU0VSVklDRSAtIFN0YXJ0IG9wZW5pbmcgcHJlcCBlcnJvcjonLCBlcnJvcilcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9LFxuXG4gIC8vIFN0YXJ0IG9wZW5pbmcgc3RhdGVtZW50cyBwaGFzZVxuICBhc3luYyBzdGFydE9wZW5pbmdTdGF0ZW1lbnRzKHJvb21JZDogc3RyaW5nKTogUHJvbWlzZTxSb29tIHwgbnVsbD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zb2xlLmxvZygn8J+OpCBST09NIFNFUlZJQ0UgLSBTdGFydGluZyBvcGVuaW5nIHN0YXRlbWVudHMgZm9yIHJvb206Jywgcm9vbUlkLnNsaWNlKC04KSlcbiAgICAgIFxuICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3Jvb21zJylcbiAgICAgICAgLnVwZGF0ZSh7IFxuICAgICAgICAgIGN1cnJlbnRfcGhhc2U6ICdvcGVuaW5nJyxcbiAgICAgICAgICBwaGFzZV9zdGFydF90aW1lOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgcGhhc2VfZHVyYXRpb246IDcwIC8vIDMwcyArIDEwcyB0cmFuc2l0aW9uICsgMzBzXG4gICAgICAgIH0pXG4gICAgICAgIC5lcSgnaWQnLCByb29tSWQpXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuc2luZ2xlKClcblxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBST09NIFNFUlZJQ0UgLSBFcnJvciBzdGFydGluZyBvcGVuaW5nIHN0YXRlbWVudHM6JywgZXJyb3IpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIHN0YXJ0IG9wZW5pbmcgc3RhdGVtZW50czogJHtlcnJvci5tZXNzYWdlfWApXG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKCfinIUgUk9PTSBTRVJWSUNFIC0gT3BlbmluZyBzdGF0ZW1lbnRzIHN0YXJ0ZWQgc3VjY2Vzc2Z1bGx5JylcbiAgICAgIHJldHVybiBkYXRhXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBST09NIFNFUlZJQ0UgLSBTdGFydCBvcGVuaW5nIHN0YXRlbWVudHMgZXJyb3I6JywgZXJyb3IpXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfSxcblxuICAvLyBTdGFydCByZWJ1dHRhbCBwaGFzZVxuICBhc3luYyBzdGFydFJlYnV0dGFsUGhhc2Uocm9vbUlkOiBzdHJpbmcpOiBQcm9taXNlPFJvb20gfCBudWxsPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKCfwn5SEIFJPT00gU0VSVklDRSAtIFN0YXJ0aW5nIHJlYnV0dGFsIHBoYXNlIGZvciByb29tOicsIHJvb21JZC5zbGljZSgtOCkpXG4gICAgICBcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdyb29tcycpXG4gICAgICAgIC51cGRhdGUoeyBcbiAgICAgICAgICBjdXJyZW50X3BoYXNlOiAncmVidXR0YWwnLFxuICAgICAgICAgIHBoYXNlX3N0YXJ0X3RpbWU6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICBwaGFzZV9kdXJhdGlvbjogNzAgLy8gMzBzICsgMTBzIHRyYW5zaXRpb24gKyAzMHMgKHNhbWUgYXMgb3BlbmluZylcbiAgICAgICAgfSlcbiAgICAgICAgLmVxKCdpZCcsIHJvb21JZClcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5zaW5nbGUoKVxuXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcign4p2MIFJPT00gU0VSVklDRSAtIEVycm9yIHN0YXJ0aW5nIHJlYnV0dGFsIHBoYXNlOicsIGVycm9yKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBzdGFydCByZWJ1dHRhbCBwaGFzZTogJHtlcnJvci5tZXNzYWdlfWApXG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKCfinIUgUk9PTSBTRVJWSUNFIC0gUmVidXR0YWwgcGhhc2Ugc3RhcnRlZCBzdWNjZXNzZnVsbHknKVxuICAgICAgcmV0dXJuIGRhdGFcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign4p2MIFJPT00gU0VSVklDRSAtIFN0YXJ0IHJlYnV0dGFsIHBoYXNlIGVycm9yOicsIGVycm9yKVxuICAgICAgdGhyb3cgZXJyb3JcbiAgICB9XG4gIH0sIFxuXG4gIC8vIEVuaGFuY2VkIHN1YnNjcmlwdGlvbiB3aXRoIGJldHRlciBlcnJvciBoYW5kbGluZ1xuICBzdWJzY3JpYmVUb1Jvb20ocm9vbUlkOiBzdHJpbmcsIGNhbGxiYWNrOiAocm9vbTogUm9vbSkgPT4gdm9pZCkge1xuICAgIGNvbnNvbGUubG9nKCfwn5OhIFJPT00gU0VSVklDRSAtIFNldHRpbmcgdXAgc3Vic2NyaXB0aW9uIGZvciByb29tOicsIHJvb21JZC5zbGljZSgtOCkpXG4gICAgXG4gICAgY29uc3QgY2hhbm5lbCA9IHN1cGFiYXNlXG4gICAgICAuY2hhbm5lbChgcm9vbToke3Jvb21JZH06JHtEYXRlLm5vdygpfWApXG4gICAgICAub24oXG4gICAgICAgICdwb3N0Z3Jlc19jaGFuZ2VzJyxcbiAgICAgICAge1xuICAgICAgICAgIGV2ZW50OiAnKicsXG4gICAgICAgICAgc2NoZW1hOiAncHVibGljJyxcbiAgICAgICAgICB0YWJsZTogJ3Jvb21zJyxcbiAgICAgICAgICBmaWx0ZXI6IGBpZD1lcS4ke3Jvb21JZH1gLFxuICAgICAgICB9LFxuICAgICAgICAocGF5bG9hZDogYW55KSA9PiB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ/CflIQgUk9PTSBTRVJWSUNFIC0gUmVhbC10aW1lIHVwZGF0ZSByZWNlaXZlZDonLCB7XG4gICAgICAgICAgICBldmVudDogcGF5bG9hZC5ldmVudFR5cGUsXG4gICAgICAgICAgICBuZXc6IHBheWxvYWQubmV3ID8ge1xuICAgICAgICAgICAgICBpZDogcGF5bG9hZC5uZXcuaWQuc2xpY2UoLTgpLFxuICAgICAgICAgICAgICBwbGF5ZXJfYV9pZDogcGF5bG9hZC5uZXcucGxheWVyX2FfaWQgPyBwYXlsb2FkLm5ldy5wbGF5ZXJfYV9pZC5zbGljZSgtOCkgOiBudWxsLFxuICAgICAgICAgICAgICBwbGF5ZXJfYl9pZDogcGF5bG9hZC5uZXcucGxheWVyX2JfaWQgPyBwYXlsb2FkLm5ldy5wbGF5ZXJfYl9pZC5zbGljZSgtOCkgOiBudWxsLFxuICAgICAgICAgICAgICBzdGF0dXM6IHBheWxvYWQubmV3LnN0YXR1cyxcbiAgICAgICAgICAgICAgY3VycmVudF9waGFzZTogcGF5bG9hZC5uZXcuY3VycmVudF9waGFzZVxuICAgICAgICAgICAgfSA6IG51bGxcbiAgICAgICAgICB9KVxuICAgICAgICAgIFxuICAgICAgICAgIGlmIChwYXlsb2FkLm5ldykge1xuICAgICAgICAgICAgY2FsbGJhY2socGF5bG9hZC5uZXcgYXMgUm9vbSlcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIClcbiAgICAgIC5zdWJzY3JpYmUoKHN0YXR1czogc3RyaW5nLCBlcnJvcj86IEVycm9yKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfwn5OhIFJPT00gU0VSVklDRSAtIFN1YnNjcmlwdGlvbiBzdGF0dXM6Jywgc3RhdHVzKVxuICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgUk9PTSBTRVJWSUNFIC0gU3Vic2NyaXB0aW9uIGVycm9yOicsIGVycm9yKVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpZiAoc3RhdHVzID09PSAnU1VCU0NSSUJFRCcpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygn4pyFIFJPT00gU0VSVklDRSAtIFN1Y2Nlc3NmdWxseSBzdWJzY3JpYmVkIHRvIHJvb20gdXBkYXRlcycpXG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICByZXR1cm4gY2hhbm5lbFxuICB9XG59Il0sIm5hbWVzIjpbInN1cGFiYXNlIiwicm9sZU1hbmFnZXIiLCJERUJBVEVfVE9QSUNTIiwiZ2VuZXJhdGVVVUlEIiwiY3J5cHRvIiwicmFuZG9tVVVJRCIsInJlcGxhY2UiLCJjIiwiciIsIk1hdGgiLCJyYW5kb20iLCJ2IiwidG9TdHJpbmciLCJpc1ZhbGlkVVVJRCIsInV1aWQiLCJ1dWlkUmVnZXgiLCJ0ZXN0Iiwicm9vbVNlcnZpY2UiLCJnZXRVc2VySWQiLCJkYXRhIiwiZXJyb3IiLCJhdXRoIiwiZ2V0VXNlciIsInVzZXIiLCJpZCIsImdldFNlc3Npb25JZCIsImNyZWF0ZVJvb20iLCJwbGF5ZXJOYW1lIiwidXNlcklkIiwiY29uc29sZSIsImxvZyIsInNsaWNlIiwicmFuZG9tVG9waWMiLCJmbG9vciIsImxlbmd0aCIsInJvb21EYXRhIiwidG9waWMiLCJzdGF0dXMiLCJwbGF5ZXJfYV9oZWFsdGgiLCJwbGF5ZXJfYl9oZWFsdGgiLCJwbGF5ZXJfYV9yZWFkeSIsInBsYXllcl9iX3JlYWR5IiwicGxheWVyX2FfaWQiLCJwbGF5ZXJfYV9uYW1lIiwiZnJvbSIsImluc2VydCIsInNlbGVjdCIsInNpbmdsZSIsIkVycm9yIiwibWVzc2FnZSIsInJvb20iLCJwbGF5ZXJSb2xlIiwiam9pblJvb20iLCJyb29tSWQiLCJjdXJyZW50Um9vbSIsImFjdHVhbFVzZXJJZCIsImZldGNoRXJyb3IiLCJlcSIsImNvZGUiLCJwbGF5ZXJfYl9pZCIsInVwZGF0ZURhdGEiLCJwbGF5ZXJfYl9uYW1lIiwidXBkYXRlZFJvb20iLCJ1cGRhdGVFcnJvciIsInVwZGF0ZSIsInJlYWR5VXAiLCJyb29tUGxheWVyQSIsInJvb21QbGF5ZXJCIiwiYm90aFJlYWR5Iiwic3RhcnRHYW1lV2l0aFNpZGVTZWxlY3Rpb24iLCJkZWFkbGluZSIsIkRhdGUiLCJub3ciLCJjdXJyZW50X3BoYXNlIiwic2lkZV9zZWxlY3Rpb25fZGVhZGxpbmUiLCJ0b0lTT1N0cmluZyIsInBoYXNlX3N0YXJ0X3RpbWUiLCJwaGFzZV9kdXJhdGlvbiIsInN1Ym1pdFNpZGVWb3RlIiwic2lkZSIsInBsYXllcl9hX3NpZGVfdm90ZSIsInBsYXllcl9iX3NpZGVfdm90ZSIsImZpbmFsaXplU2lkZVNlbGVjdGlvbiIsInBsYXllckFTaWRlIiwicGxheWVyQlNpZGUiLCJwbGF5ZXJBVm90ZSIsInBsYXllckJWb3RlIiwicGxheWVyX2Ffc2lkZSIsInBsYXllcl9iX3NpZGUiLCJzZW5kTWVzc2FnZSIsImNvbnRlbnQiLCJwaGFzZSIsInBsYXllclNpZGUiLCJjb250ZW50TGVuZ3RoIiwic2VuZGVyTmFtZSIsInRvVXBwZXJDYXNlIiwic3RvcmVkTmFtZSIsIm1lc3NhZ2VEYXRhIiwicm9vbV9pZCIsInVzZXJfaWQiLCJzZW5kZXJfbmFtZSIsInBsYXllcl9zaWRlIiwiZ2V0TWVzc2FnZXMiLCJvcmRlciIsImFzY2VuZGluZyIsInN1YnNjcmliZVRvTWVzc2FnZXMiLCJjYWxsYmFjayIsImNoYW5uZWwiLCJvbiIsImV2ZW50Iiwic2NoZW1hIiwidGFibGUiLCJmaWx0ZXIiLCJwYXlsb2FkIiwic2VuZGVyIiwibmV3Iiwic3Vic2NyaWJlIiwidW5yZWFkeSIsImxlYXZlUm9vbSIsImdldFJvb20iLCJzdGFydE9wZW5pbmdQcmVwIiwic3RhcnRPcGVuaW5nU3RhdGVtZW50cyIsInN0YXJ0UmVidXR0YWxQaGFzZSIsInN1YnNjcmliZVRvUm9vbSIsImV2ZW50VHlwZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/lib/roomService.ts\n"));

/***/ })

});